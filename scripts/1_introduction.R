################################################################################
#                                                                              #
#                     "Reproducible Data Analysis with R"                      #
#                     CÃ©dric Scherer | Feb 27-Mar 3, 2023                      #
#                                                                              #
#                              --- Session 1 ---                               #
#                      "Introduction to R (and RStudio)"                       #
#                                                                              #
################################################################################


## PREPARATION #################################################################

## To follow the workshop, you need to have a recent version of R and RStudio
## installed on your machine. Download R via https://cloud.r-project.org/ and 
## RStudio Desktop via https://posit.co/download/rstudio-desktop/

## This is an R script. 
## - non-empty lines without that don not start with a hash tag are code
##   -> run the code by clicking the "Run" button
##   -> run the code by placing your cursor in that line and hit Cmd+Enter
##   -> run the code by copy-pasting your code into the console (not preferred)
## - Lines that start with a hash tag are comments, i.e. are not run.
##   -> You can also add comments after your code as illustrated below:

1  ## the 1 on the left is code, everything after the hash tag is not evaluated

## You will learn about packages within this session. 
## Don't worry, we will install all packages as we encounter them.
## Just make sure that you have sufficient rights to install packages on your
## machine by running the following:
install.packages("palmerpenguins")


## That's it---let's start!




## -----------------------------------------------------------------------------
1


## -----------------------------------------------------------------------------
"Hello World!"


## -----------------------------------------------------------------------------
"2023-02-27 09:00:00"


## -----------------------------------------------------------------------------
x


## -----------------------------------------------------------------------------
"x"


## -----------------------------------------------------------------------------
pi


## -----------------------------------------------------------------------------
sqrt(x = 25)


## -----------------------------------------------------------------------------
-1


## -----------------------------------------------------------------------------
12 %% 5


## -----------------------------------------------------------------------------
log


## -----------------------------------------------------------------------------
mean


## -----------------------------------------------------------------------------
methods(mean)


## -----------------------------------------------------------------------------
`+`


## -----------------------------------------------------------------------------
read.csv


## -----------------------------------------------------------------------------
read.table


## -----------------------------------------------------------------------------
log(x = 25)  ## `base = exp(1)` as default


## -----------------------------------------------------------------------------
log(x = 25, base = 10)


## -----------------------------------------------------------------------------
log10(x = 25)  ## wrapper for `log(x, base = 10)`


## -----------------------------------------------------------------------------
log2(x = 25)  ## wrapper for `log(x, base = 2)`


## -----------------------------------------------------------------------------
help(log)
?log
# cursor + F1


## -----------------------------------------------------------------------------
log(x = 25, base = 5)


## -----------------------------------------------------------------------------
log(25, 5)  ## the 1st argument is `x`, the 2nd `base`


## -----------------------------------------------------------------------------
log(5, 25)  ## the 1st argument is `x`, the 2nd `base`


## -----------------------------------------------------------------------------
log(25, base = 5)  ## the 1st argument is `x`


## -----------------------------------------------------------------------------
log(base = 5, 25)  ## it works but don't do this


## -----------------------------------------------------------------------------
log(base = 5, x = 25)  ## be explicit if you want to switch argument positions


## -----------------------------------------------------------------------------
quantile(x = c(5, 1, 3), probs = c(0.25, 0.5, 0.75))


## -----------------------------------------------------------------------------
quantile(c(5, 1, 3), c(0.25, 0.5, 0.75))


## -----------------------------------------------------------------------------
quantile(c(0.25, 0.5, 0.75), c(5, 1, 3))


## -----------------------------------------------------------------------------
quantile(c(0.25, 0.5, 0.75), c(0.95, 0.345, 1))


## -----------------------------------------------------------------------------
name <- "Cedric"
name


## -----------------------------------------------------------------------------
"Dresden" -> city  ## right-hand asignment
city


## -----------------------------------------------------------------------------
country = "Germany"  ## a single `=` can also be used for assignment
country


## -----------------------------------------------------------------------------
country == "Germany" ## a double `=` compares two values!


## -----------------------------------------------------------------------------
language == "English" ## a double `=` compares two values!


## -----------------------------------------------------------------------------
log(25, base = 5) ## inside functions a single `=` defines argument inputs!


## -----------------------------------------------------------------------------
one <- 1
one


## -----------------------------------------------------------------------------
log(one)


## -----------------------------------------------------------------------------
one <- "1"
one


## -----------------------------------------------------------------------------
log(one)


## -----------------------------------------------------------------------------
typeof("Hello World!")


## -----------------------------------------------------------------------------
typeof(1)


## -----------------------------------------------------------------------------
typeof(1L)


## -----------------------------------------------------------------------------
typeof(1i)


## -----------------------------------------------------------------------------
typeof(TRUE)


## -----------------------------------------------------------------------------
typeof(1)


## -----------------------------------------------------------------------------
class(1)


## -----------------------------------------------------------------------------
typeof(1L)


## -----------------------------------------------------------------------------
class(1L)


## -----------------------------------------------------------------------------
typeof(1i)


## -----------------------------------------------------------------------------
class(1i)


## -----------------------------------------------------------------------------
as.character(1)


## -----------------------------------------------------------------------------
as.integer(1)


## -----------------------------------------------------------------------------
as.complex(1)


## -----------------------------------------------------------------------------
as.logical(1)


## -----------------------------------------------------------------------------
as.logical(0)


## -----------------------------------------------------------------------------
typeof("2023-02-27 09:00:00")


## -----------------------------------------------------------------------------
as.Date("2023-02-27 09:00:00")


## -----------------------------------------------------------------------------
typeof(as.Date("2023-02-27 09:00:00"))


## -----------------------------------------------------------------------------
as.POSIXct("2023-02-27 09:00:00")


## -----------------------------------------------------------------------------
typeof(as.POSIXct("2023-02-27 09:00:00"))


## -----------------------------------------------------------------------------
as.POSIXlt("2023-02-27 09:00:00")


## -----------------------------------------------------------------------------
date <- "27.02.2023 09:00"


## -----------------------------------------------------------------------------
as.POSIXct(date)


## -----------------------------------------------------------------------------
as.POSIXct(date, format = "%d.%m.%Y %H:%M")


## -----------------------------------------------------------------------------
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "EST")


## -----------------------------------------------------------------------------
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "America/New_York")

## -----------------------------------------------------------------------------
as.POSIXct(date, format = "%d.%m.%Y %H:%M", tz = "US/Eastern")


## -----------------------------------------------------------------------------
typeof(NA)


## -----------------------------------------------------------------------------
typeof(NA_character_)


## -----------------------------------------------------------------------------
typeof(NA_integer_)


## -----------------------------------------------------------------------------
typeof(NA_real_)


## -----------------------------------------------------------------------------
typeof(NA_complex_)


## -----------------------------------------------------------------------------
NaN


## -----------------------------------------------------------------------------
0 / 0


## -----------------------------------------------------------------------------
is.nan(0 / 0)


## -----------------------------------------------------------------------------
is.na(0 / 0)


## -----------------------------------------------------------------------------
NA == "Cedric"


## -----------------------------------------------------------------------------
NaN == 1


## -----------------------------------------------------------------------------
NA == NA


## -----------------------------------------------------------------------------
NaN == (0 / 0)


## -----------------------------------------------------------------------------
## NA <- 1


## -----------------------------------------------------------------------------
ids <- c(1:5)
ids


## -----------------------------------------------------------------------------
typeof(ids)


## -----------------------------------------------------------------------------
names <- c("Manisha", "Julien", "Cornelia", "Tatyana", "Eman")
names


## -----------------------------------------------------------------------------
typeof(names)


## -----------------------------------------------------------------------------
(colors <- c(green = "#28A87D", purple = "#9C55E3", yellow = "#EFAC00")) 


## -----------------------------------------------------------------------------
colors <- c("#28A87D", "#9C55E3", "#EFAC00")
names(colors) <- c("green", "purple", "yellow")
colors


## -----------------------------------------------------------------------------
unname(colors)


## -----------------------------------------------------------------------------
names


## -----------------------------------------------------------------------------
names[1]


## -----------------------------------------------------------------------------
names[3:5]


## -----------------------------------------------------------------------------
names[c(1:3, 5)]


## -----------------------------------------------------------------------------
names[-2]


## -----------------------------------------------------------------------------
colors


## -----------------------------------------------------------------------------
colors[c(1, 3)]


## -----------------------------------------------------------------------------
colors["purple"]


## -----------------------------------------------------------------------------
colors[c("green", "yellow")]


## -----------------------------------------------------------------------------
x <- c(1, 2, 3, NA, 5)
y <- c("A", "B", NA, "D", "E")


## -----------------------------------------------------------------------------
typeof(x)


## -----------------------------------------------------------------------------
typeof(y)


## -----------------------------------------------------------------------------
x <- c(5, 12, NA, 2, 18)
mean(x)


## -----------------------------------------------------------------------------
y <- c(5, 12, NaN, 2, 18)
mean(y)


## -----------------------------------------------------------------------------
mean(x, na.rm = TRUE)  ## `na.rm = FALSE` by default


## -----------------------------------------------------------------------------
mean(y, na.rm = TRUE)


## -----------------------------------------------------------------------------
colors_ext <- c(colors, c("#000000", "#ffffff"))


## -----------------------------------------------------------------------------
colors_ext


## -----------------------------------------------------------------------------
colors_ext <- c(colors, c(black = "#000000", white = "#ffffff"))


## -----------------------------------------------------------------------------
colors_ext


## -----------------------------------------------------------------------------
comb_vec <- c(ids, names)


## -----------------------------------------------------------------------------
comb_vec


## -----------------------------------------------------------------------------
v1 <- c("ggplot2", 2023, TRUE)
v1


## -----------------------------------------------------------------------------
typeof(v1)


## -----------------------------------------------------------------------------
v2 <- c(0.2, 1L, 3 + 0i)
v2


## -----------------------------------------------------------------------------
typeof(v2)


## -----------------------------------------------------------------------------
typeof(c(TRUE))


## -----------------------------------------------------------------------------
typeof(c(TRUE, 1L))


## -----------------------------------------------------------------------------
typeof(c(TRUE, 1L, 0.2))


## -----------------------------------------------------------------------------
typeof(c(TRUE, 1L, 0.2, 1 + 0i))


## -----------------------------------------------------------------------------
typeof(c(TRUE, 1L, 0.2, 1 + 0i, "a"))


## -----------------------------------------------------------------------------
v1


## -----------------------------------------------------------------------------
as.numeric(v1)


## -----------------------------------------------------------------------------
as.logical(v1)


## -----------------------------------------------------------------------------
v1


## -----------------------------------------------------------------------------
as.numeric(v1)


## -----------------------------------------------------------------------------
as.logical(v1)


## -----------------------------------------------------------------------------
as.logical(2023)


## -----------------------------------------------------------------------------
as.logical("2023")


## -----------------------------------------------------------------------------
v2


## -----------------------------------------------------------------------------
as.integer(v2)


## -----------------------------------------------------------------------------
as.character(v2)


## -----------------------------------------------------------------------------
as.logical(v2)


## -----------------------------------------------------------------------------
as.logical(as.character(v2))


## -----------------------------------------------------------------------------
as.logical(as.integer(v2))


## -----------------------------------------------------------------------------
(v <- c("good", "neutral", "bad"))


## -----------------------------------------------------------------------------
as.factor(v)


## -----------------------------------------------------------------------------
factor(v)


## -----------------------------------------------------------------------------
factor(v, levels = c("good", "neutral", "bad"))


## -----------------------------------------------------------------------------
factor(v, levels = rev(v))


## -----------------------------------------------------------------------------
(n <- 0:3)


## -----------------------------------------------------------------------------
(f <- factor(n))


## -----------------------------------------------------------------------------
(f <- factor(n, levels = c(1:3, 0)))


## -----------------------------------------------------------------------------
mean(n)


## -----------------------------------------------------------------------------
mean(f)


## -----------------------------------------------------------------------------
levels(f)


## -----------------------------------------------------------------------------
(ff <- factor(
  n, levels = c(1:3, 0), labels = c("bad", "neutral", "good", "n/a")
))


## -----------------------------------------------------------------------------
levels(ff)


## -----------------------------------------------------------------------------
ff


## -----------------------------------------------------------------------------
as.numeric(ff)


## -----------------------------------------------------------------------------
as.character(ff)


## -----------------------------------------------------------------------------
f


## -----------------------------------------------------------------------------
as.numeric(f)


## -----------------------------------------------------------------------------
as.numeric(as.character(f))


## -----------------------------------------------------------------------------
# install.packages("forcats")
## provides functions to work with factors


## -----------------------------------------------------------------------------
# install.packages("palmerpenguins")
## contains data sets for educational use


## -----------------------------------------------------------------------------
library(forcats)


## -----------------------------------------------------------------------------
f <- factor(0:10)
levels(f)
fct_rev(f)
fct_relevel(f, "0", after = Inf)


## -----------------------------------------------------------------------------
library(palmerpenguins)


## -----------------------------------------------------------------------------
penguins


## -----------------------------------------------------------------------------
# install.packages("dplyr")
## provides functions to wrangle tabular data


## -----------------------------------------------------------------------------
library(dplyr)


## -----------------------------------------------------------------------------
# install.packages("stringr")
## provides functions to work with character strings


## -----------------------------------------------------------------------------
stringr::str_to_sentence(c("coffee", "latte machiatto", "espresso"))


## -----------------------------------------------------------------------------
(df_participants <- data.frame(ids, names))


## -----------------------------------------------------------------------------
(df_participants <- data.frame(id = ids, participant_name = names))


## -----------------------------------------------------------------------------
df_participants[2,]


## -----------------------------------------------------------------------------
df_participants[,2]


## -----------------------------------------------------------------------------
df_participants$participant_name


## -----------------------------------------------------------------------------
df_participants[[2]]


## -----------------------------------------------------------------------------
df_participants$participant_name[2]


## -----------------------------------------------------------------------------
df_participants[[2]][2]


## -----------------------------------------------------------------------------
df_participants[,2][2]


## -----------------------------------------------------------------------------
df_participants


## -----------------------------------------------------------------------------
df_participants$participant


## -----------------------------------------------------------------------------
# install.packages("tibble")


## -----------------------------------------------------------------------------
(tbl_participants <- tibble::tibble(id = ids, participant_name = names))


## -----------------------------------------------------------------------------
df_long  <- data.frame(
  id = 1:1000 %% 10, value = runif(n = 1000, min = 0, max = 1000)
)


## -----------------------------------------------------------------------------
tbl_long <- tibble::tibble(
  id = 1:1000 %% 10, value = runif(n = 1000, min = 0, max = 1000)
)


## -----------------------------------------------------------------------------
df_long


## -----------------------------------------------------------------------------
tbl_long


## -----------------------------------------------------------------------------
as.data.frame(penguins)


## -----------------------------------------------------------------------------
tibble::as_tibble(penguins)


## -----------------------------------------------------------------------------
df_long$val


## -----------------------------------------------------------------------------
tbl_long$val


## -----------------------------------------------------------------------------
View(tbl_long)


## -----------------------------------------------------------------------------
dim(tbl_long)


## -----------------------------------------------------------------------------
str(tbl_long)


## -----------------------------------------------------------------------------
tibble::glimpse(tbl_long)


## -----------------------------------------------------------------------------
summary(tbl_long)


## -----------------------------------------------------------------------------
mean(tbl_long$value)


## -----------------------------------------------------------------------------
range(tbl_long$value)


## -----------------------------------------------------------------------------
unique(tbl_long$id)


## -----------------------------------------------------------------------------
sort(unique(tbl_long$id))


## -----------------------------------------------------------------------------
length(tbl_long$id)


## -----------------------------------------------------------------------------
length(unique(tbl_long$id))


## -----------------------------------------------------------------------------
my_list <- list(
  ids = 1:5, 
  names = c("Manisha", "Julien", "Cornelia", "Tatyana", "Eman")
)


## -----------------------------------------------------------------------------
my_list


## -----------------------------------------------------------------------------
my_list$names


## -----------------------------------------------------------------------------
my_list$names[1]


## -----------------------------------------------------------------------------
my_list[[2]]


## -----------------------------------------------------------------------------
my_list[[2]][1]


## -----------------------------------------------------------------------------
my_nested_list <- list(
  ids = list(1:5, 1), 
  names = list(c("Manisha", "Julien", "Cornelia", "Tatyana", "Eman"), "Cedric"),
  type = list(rep("participant", 5), "instructor")
)


## -----------------------------------------------------------------------------
my_nested_list


## -----------------------------------------------------------------------------
my_nested_list$names


## -----------------------------------------------------------------------------
my_nested_list$names[[1]]


## -----------------------------------------------------------------------------
my_nested_list$names[[1]][1]


## -----------------------------------------------------------------------------
my_nested_list[[2]][[1]][1]


## -----------------------------------------------------------------------------
my_tbl_list <- tibble::as_tibble(my_nested_list)


## -----------------------------------------------------------------------------
my_tbl_list


## -----------------------------------------------------------------------------
# install.packages("tidyr")


## -----------------------------------------------------------------------------
my_tbl <- tidyr::unnest(my_tbl_list)


## -----------------------------------------------------------------------------
my_tbl <- tidyr::unnest(my_tbl_list, cols = c(ids, names, type))


## -----------------------------------------------------------------------------
my_tbl


## -----------------------------------------------------------------------------
my_nested_tbl <- tidyr::nest(my_tbl, data = !type)


## -----------------------------------------------------------------------------
my_nested_tbl


## -----------------------------------------------------------------------------
my_nested_tbl$data


## -----------------------------------------------------------------------------
1:10


## -----------------------------------------------------------------------------
seq(from = 0, to = 150, by = 25)


## -----------------------------------------------------------------------------
0:6*25


## -----------------------------------------------------------------------------
seq(from = 0, to = 150, length.out = 5)


## -----------------------------------------------------------------------------
rep(1:3, times = 3)


## -----------------------------------------------------------------------------
rep(1:3, each = 3)


## -----------------------------------------------------------------------------
name <- c("Brian", "Jason", "Tyler", "Sam")
age <- seq(23, 29, by = 2)  ## or: c(23, 24, 25, 26)
sex <- rep("male", length(name))
id <- 1:length(name)


## -----------------------------------------------------------------------------
tibble::tibble(id, name, age, sex) ## or `data.frame()`


## -----------------------------------------------------------------------------
tibble::tibble(
  name = c("Brian", "Jason", "Tyler", "Sam"),
  age = seq(23, 29, by = 2),  
  sex = rep("male", 4),
  id = 1:4
)


## -----------------------------------------------------------------------------
tibble::tribble(
  ~id, ~name,    ~age,  ~sex,
  1,   "Brian",  23,    "male", 
  2,   "Jason",  25,    "male", 
  3,   "Tyler",  27,    "male", 
  4,   "Sam",    29,    "male"
)

