<!DOCTYPE html>
<html lang="en"><head>
<script src="4_modeling_files/libs/clipboard/clipboard.min.js"></script>
<script src="4_modeling_files/libs/quarto-html/tabby.min.js"></script>
<script src="4_modeling_files/libs/quarto-html/popper.min.js"></script>
<script src="4_modeling_files/libs/quarto-html/tippy.umd.min.js"></script>
<link href="4_modeling_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="4_modeling_files/libs/quarto-html/light-border.css" rel="stylesheet">
<link href="4_modeling_files/libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="4_modeling_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.191">

  <meta name="author" content="Cédric Scherer // R Course TU Dresden // Feb 27–Mar 3, 2023">
  <title>&nbsp;Reproducible Data Analysis with R</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="4_modeling_files/libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="4_modeling_files/libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
      }
    pre.numberSource { margin-left: 3em;  padding-left: 4px; }
    div.sourceCode
      { color: #000000; background-color: #ffffff; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #000000; } /* Normal */
    code span.al { color: #bf0303; background-color: #f7e6e6; font-weight: bold; } /* Alert */
    code span.an { color: #ca60ca; } /* Annotation */
    code span.at { color: #0057ae; } /* Attribute */
    code span.bn { color: #b08000; } /* BaseN */
    code span.bu { color: #644a9b; } /* BuiltIn */
    code span.cf { color: #000000; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #924c9d; } /* Char */
    code span.cn { color: #aa5500; } /* Constant */
    code span.co { color: #898887; } /* Comment */
    code span.cv { color: #0095ff; } /* CommentVar */
    code span.do { color: #607880; } /* Documentation */
    code span.dt { color: #0057ae; } /* DataType */
    code span.dv { color: #b08000; } /* DecVal */
    code span.er { color: #bf0303; text-decoration: underline; } /* Error */
    code span.ex { color: #0095ff; font-weight: bold; } /* Extension */
    code span.fl { color: #b08000; } /* Float */
    code span.fu { color: #644a9b; } /* Function */
    code span.im { color: #644a9b; } /* Import */
    code span.in { color: #b08000; } /* Information */
    code span.kw { color: #000000; font-weight: bold; } /* Keyword */
    code span.op { color: #000000; } /* Operator */
    code span.ot { color: #006e28; } /* Other */
    code span.pp { color: #006e28; } /* Preprocessor */
    code span.re { color: #0057ae; background-color: #e0e9f8; } /* RegionMarker */
    code span.sc { color: #ff5500; } /* SpecialChar */
    code span.ss { color: #ff5500; } /* SpecialString */
    code span.st { color: #bf0303; } /* String */
    code span.va { color: #0057ae; } /* Variable */
    code span.vs { color: #bf0303; } /* VerbatimString */
    code span.wa { color: #bf0303; } /* Warning */
  </style>
  <link rel="stylesheet" href="4_modeling_files/libs/revealjs/dist/theme/quarto.css" id="theme">
  <link href="4_modeling_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="4_modeling_files/libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="4_modeling_files/libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="4_modeling_files/libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="4_modeling_files/libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="4_modeling_files/libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-captioned.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-captioned) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-captioned.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-captioned .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-captioned .callout-caption  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-captioned.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-captioned.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-caption {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-caption {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-caption {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-captioned .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-captioned .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-captioned) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-caption {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-caption {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-caption {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-caption {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-caption {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">&nbsp;Reproducible Data Analysis with R</h1>
  <p class="subtitle">— Statistical Analysis &amp; Modeling —</p>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
<b style="color:#28a87d;"><a href="https://www.cedricscherer.com">Cédric Scherer</a></b> <strong>//</strong> R Course TU Dresden <strong>//</strong> Feb 27–Mar 3, 2023 
</div>
</div>
</div>

</section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-workflow.png" alt="A conceptional representation of the data science workflow:the first step is data import, afterwards the data gets tidied (prepared, shaped). Then follows an iterative process of visualization, transformation and modeling. Once the final analysis is done, the results need to be communicated." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-visualize-done.png" alt="The same conceptional representation of the data science workflow with the steps import, tidy, transform, and visualize being highlighted in green (as we have already covered these steps)." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-model.png" alt="The same conceptional representation of the data science workflow with the step model being highlighted in yellow (as it is coming next)." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section>
<section id="statistical-models" class="slide level2">
<h2>Statistical Models</h2>
<p>A statistical model is a mathematical representation of observed data:</p>
<blockquote>
<p>A statistical model is a class of mathematical model, which embodies a set of assumptions concerning the generation of some sample data, and similar data from a larger population.<br><br>A statistical model represents, often in considerably idealized form, the<br>data-generating process.</p>
</blockquote>
<div class="small">
<p>Source: <a href="https://en.wikipedia.org/wiki/Statistical_model">Wikipedia</a></p>
</div>
</section>
<section id="statistical-models-1" class="slide level2">
<h2>Statistical Models</h2>
<p>A statistical model is a mathematical representation of observed data:</p>
<blockquote>
<p>A statistical model is a class of mathematical model, which embodies a set of assumptions concerning the generation of some sample data, and similar data from a larger population.<br><br>A statistical model represents, often in considerably idealized form, the<br><span class="circle-highlight">data-generating process</span>.</p>
</blockquote>
<div class="small">
<p>Source: <a href="https://en.wikipedia.org/wiki/Statistical_model">Wikipedia</a></p>
</div>
<div class="fragment">
<p>→ data is generated by a probabilistic process</p>
</div>
<div class="fragment">
<p>→ each element of the population is selected with a (known) probability</p>
</div>
<div class="fragment">
<p>→ it is <em>(should be)</em>&nbsp;&nbsp;possible to infer features of the population</p>
</div>
</section>
<section id="our-example-data" class="slide level2">
<h2>Our Example Data 🦉🕊️🦅</h2>
<div>
<ul>
<li class="fragment">data set on <strong>54 bird families</strong> recorded on a site in North America</li>
<li class="fragment">the following variables are reported:
<ul>
<li class="fragment">the <strong>species</strong></li>
<li class="fragment">the <strong>diet type</strong> of the species</li>
<li class="fragment">a yes/no classification if the species is a <strong>passerine or not</strong></li>
<li class="fragment">a yes/no classification if the species is considered <strong>aquatic or not</strong></li>
<li class="fragment">the <strong>average and maximum abundance</strong> observed at the site</li>
<li class="fragment">the <strong>average body mass</strong> in grams</li>
</ul></li>
<li class="fragment">provided as educational resource by the <a href="https://github.com/QCBSRworkshops/workshop04/tree/main/book-en/data">Quebec Centre for Biodiversity Science</a></li>
</ul>
</div>
</section>
<section id="our-example-data-1" class="slide level2">
<h2>Our Example Data 🦉🕊️🦅</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-2_000066132768389fdb5658bc3c3a0197">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>birds <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/birds.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-3_c85fd68104a596663f7b5fe5237648f7">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 7
   family             max_abund avg_abund   mass diet        passerine aquatic
   &lt;chr&gt;                  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;           &lt;dbl&gt;   &lt;dbl&gt;
 1 Hawks&amp;Eagles&amp;Kites      2.99     0.674  716.  Vertebrate          0       0
 2 Long-tailed tits       37.8      4.04     5.3 Insect              1       0
 3 Larks                 241.      23.1     35.8 PlantInsect         1       0
 4 Kingfishers             4.4      0.595  119.  Vertebrate          0       0
 5 Auks&amp; Puffins           4.53     2.96   315.  InsectVert          0       1
 6 Ducks&amp; Geese           23.7      2.74  1144.  PlantInsect         0       1
 7 Anhingas               24.6      1.84  1250   Vertebrate          0       1
 8 Swifts                 44.0      3.95    27.4 Insect              0       0
 9 Limpkins                1.6      0.567 1100   Insect              0       1
10 Herons&amp; Egrets         46.5      2.97   462.  Vertebrate          0       1
# … with 44 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="our-example-data-2" class="slide level2">
<h2>Our Example Data 🦉🕊️🦅</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-4_938225ca8c249eb560497fe55024b394">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>birds <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/birds.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-5_1076148d239ef5c2a775ca1219af5cae">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb5-2"><a href="#cb5-2"></a>birds <span class="ot">&lt;-</span> <span class="fu">mutate</span>(birds, <span class="fu">across</span>(<span class="fu">c</span>(<span class="st">"family"</span>, <span class="st">"diet"</span>, <span class="st">"passerine"</span>, <span class="st">"aquatic"</span>), factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-6_62bca5aa0d86aeb5cfe74a21abb86599">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 7
   family             max_abund avg_abund   mass diet        passerine aquatic
   &lt;fct&gt;                  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;  
 1 Hawks&amp;Eagles&amp;Kites      2.99     0.674  716.  Vertebrate  0         0      
 2 Long-tailed tits       37.8      4.04     5.3 Insect      1         0      
 3 Larks                 241.      23.1     35.8 PlantInsect 1         0      
 4 Kingfishers             4.4      0.595  119.  Vertebrate  0         0      
 5 Auks&amp; Puffins           4.53     2.96   315.  InsectVert  0         1      
 6 Ducks&amp; Geese           23.7      2.74  1144.  PlantInsect 0         1      
 7 Anhingas               24.6      1.84  1250   Vertebrate  0         1      
 8 Swifts                 44.0      3.95    27.4 Insect      0         0      
 9 Limpkins                1.6      0.567 1100   Insect      0         1      
10 Herons&amp; Egrets         46.5      2.97   462.  Vertebrate  0         1      
# … with 44 more rows</code></pre>
</div>
</div>
</div>
</section>
<section id="our-example-data-3" class="slide level2">
<h2>Our Example Data 🦉🕊️🦅</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-7_d754e5b3622f189a1739578a436eb311">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>birds <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/birds.csv"</span>, <span class="at">col_types =</span> <span class="st">"fdddfff"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-8_14e1b2ccef9406ef7ff030aa027d2a0d">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 7
   family             max_abund avg_abund   mass diet        passerine aquatic
   &lt;fct&gt;                  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;  
 1 Hawks&amp;Eagles&amp;Kites      2.99     0.674  716.  Vertebrate  0         0      
 2 Long-tailed tits       37.8      4.04     5.3 Insect      1         0      
 3 Larks                 241.      23.1     35.8 PlantInsect 1         0      
 4 Kingfishers             4.4      0.595  119.  Vertebrate  0         0      
 5 Auks&amp; Puffins           4.53     2.96   315.  InsectVert  0         1      
 6 Ducks&amp; Geese           23.7      2.74  1144.  PlantInsect 0         1      
 7 Anhingas               24.6      1.84  1250   Vertebrate  0         1      
 8 Swifts                 44.0      3.95    27.4 Insect      0         0      
 9 Limpkins                1.6      0.567 1100   Insect      0         1      
10 Herons&amp; Egrets         46.5      2.97   462.  Vertebrate  0         1      
# … with 44 more rows</code></pre>
</div>
</div>
</div>
</section>
<section>
<section id="statistical-analysis-univariate-data" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Univariate Data —</b></h1>

</section>
<section id="univariate-data" class="slide level2">
<h2>Univariate Data</h2>
<p><span class="simple-highlight-grn">Univariate</span> describes data that consist of <strong>only a single characteristic</strong>. <br></p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-jitter-1.png" width="1000"></p>
</div>
</div>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-univariate-histogram_8de770bb8a24d1ebde8bc35e342b592b">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-histogram-1.png" width="1000"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="univariate-data-1" class="slide level2">
<h2>Univariate Data</h2>
<p><span class="simple-highlight-grn">Univariate</span> describes data that consist of <strong>only a single characteristic</strong>. <br></p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-univariate-jitter-again_50250a0aa98db36c56faf4801f073ebe" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-jitter-again-1.png" width="1000"></p>
</div>
</div>
<div class="cell quarto-layout-cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-univariate-density_1a06d507313a0d53400ebd15debe56b8" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-density-1.png" width="1000"></p>
</div>
</div>
</div>
</div>
</section>
<section id="univariate-descriptive-statistics" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p>There are two key concepts for evaluating the distribution of a single variable:</p>
<div>
<ul>
<li class="fragment"><strong>localization</strong></li>
<li class="fragment"><strong>variation</strong></li>
</ul>
</div>
</section>
<section id="univariate-descriptive-statistics-1" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p><span class="simple-highlight-grn">Localization</span> is a measure of <strong>central tendency of a population</strong>.</p>
<div class="fragment">
<p>It can be measured with the <strong>arithmetic mean</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-13_da17eb5c9e333c5bcceb7c2cbf27e91f">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="fu">mean</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5.686179</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-14_c0f85693c48a92d3b0a1485a33ec8854">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="fu">mean</span>(birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 468.4757</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>or the <strong>median</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-15_18a46b88c52d9f98ee757c05b3b26908">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">median</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.113586</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-16_b8a1d18c4905a5a5b8cc8c9dee56c0c6">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="fu">median</span>(birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 59.18297</code></pre>
</div>
</div>
</div>
</section>
<section id="univariate-descriptive-statistics-2" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p><span class="simple-highlight-grn">Variation</span> is the a measure of <strong>dispersion (or deviation) of observations</strong> around the mean.</p>
<div class="fragment">
<p>It can be measured by the <strong>variance</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-17_ea9372301002b4efb264a7a644fabc69">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">var</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 68.05705</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-18_8621cd8711c163bec2cf95e013eaf4eb">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="fu">var</span>(birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 893800.9</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Variance is the sum of the squared deviation between each value. Squaring the variance allows us to transform values into positive values without using absolute values.</p>
</div>
</section>
<section id="univariate-descriptive-statistics-3" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p>To transform the variance into appropriate units, we can calculate the<br><span class="simple-highlight-grn">standard deviation σ</span>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-19_202dff4fe07ec9b66808e0d1bef3becc">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">sd</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8.249669</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-20_f4b085c61de89b8243516bfb173189d4">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">sd</span>(birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 945.4104</code></pre>
</div>
</div>
</div>
</section>
<section id="univariate-descriptive-statistics-4" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p><b style="color:#663399;">Mean</b> and <b style="color:#000000;">median</b> differ in case the distribution is asymmetrical:</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-univariate-boxplot_2fb63daeafe1d51b5c7215b3af05a1b5" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-boxplot-1.png" width="1000"></p>
</div>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-univariate-density-mean-sd_ac3f54483bbef8f3c8a6893420ec41f8">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-univariate-density-mean-sd-1.png" width="1000"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="univariate-descriptive-statistics-5" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<p><br></p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="cell quarto-layout-cell" data-hash="4_modeling_cache/revealjs/ggplot-univariate-boxplot-metrics_1a840a0fcda10f5515ba7e502444d7b2" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-univariate-boxplot-metrics-1.png" width="1000"></p>
</div>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-univariate-density-metrics_997db20fcc0b1b5c4c7054605ac08866">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-univariate-density-metrics-1.png" width="1000"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="univariate-descriptive-statistics-6" class="slide level2">
<h2>Univariate Descriptive Statistics</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-25_2913fd1337ea4b71b836603cd1ea5a06">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">quantile</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       0%       25%       50%       75%      100% 
 0.200000  1.339712  3.113586  6.258143 47.597600 </code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-26_bdb825b6ad08257398b279f1e1fae4da">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="fu">diff</span>(<span class="fu">as.numeric</span>(<span class="fu">quantile</span>(birds<span class="sc">$</span>avg_abund, <span class="fu">c</span>(<span class="fl">0.25</span>, <span class="fl">0.75</span>)))) <span class="do">## also works without `as.numeric()`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.918432</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-27_8c088d382de1574f6dcbb7152cbb886e">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="fu">IQR</span>(birds<span class="sc">$</span>avg_abund)  <span class="do">## `diff(quantile(as.numeric(birds$avg_abund), c(0.25, 0.75)))`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.918432</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-28_95c6d99f478f9414589c6409b674c0c3">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="fu">range</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  0.2000 47.5976</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-29_29bcf0c9a892efee46004196b49e6b08">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="fu">diff</span>(<span class="fu">range</span>(birds<span class="sc">$</span>avg_abund))  <span class="do">## `max(birds$avg_abund) - min(birds$avg_abund)`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 47.3976</code></pre>
</div>
</div>
</div>
</section>
<section id="compare-distributions" class="slide level2">
<h2>Compare Distributions</h2>
<p>The <strong>Shapiro-Wilk test</strong> is used to compare the distribution of a variable with a reference probability probability distribution:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-30_7c30be2fbbe56b638605009d50dcb7ef">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="fu">shapiro.test</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  birds$avg_abund
W = 0.59272, p-value = 5.394e-11</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The values are not distributed normally.</span></p>
</div>
</section>
<section id="compare-distributions-1" class="slide level2">
<h2>Compare Distributions</h2>
<p>An alternative is the <strong>Kolmogorov-Smirnov test</strong> to test for normality:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-31_2e7bf3b49dd86df091d9c9ca856e1f93">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="fu">ks.test</span>(birds<span class="sc">$</span>avg_abund, <span class="st">"pnorm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  birds$avg_abund
D = 0.69907, p-value &lt; 2.2e-16
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The values are not distributed normally.</span></p>
</div>
</section>
<section id="compare-distributions-2" class="slide level2">
<h2>Compare Distributions</h2>
<p>The <strong>Chi-square goodness-of-fit test</strong> is much more flexible and can also be used for other distributions:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-32_62e1b2d4c4faa67a323746342c2284af">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1"></a><span class="fu">chisq.test</span>(birds<span class="sc">$</span>avg_abund, <span class="at">p =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">nrow</span>(birds), <span class="fu">nrow</span>(birds))) <span class="do">## uniform distribution</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Chi-squared test for given probabilities

data:  birds$avg_abund
X-squared = 634.35, df = 53, p-value &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values do not follow a uniform distribution</p>
</div>
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The values are not distributed uniformly.</span></p>
</div>
<p><br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-33_6c70e7107fb5b2ceff96e0570fe7aae8">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">nrow</span>(birds), <span class="fu">nrow</span>(birds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852
[10] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852
[19] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852
[28] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852
[37] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852
[46] 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852 0.01851852</code></pre>
</div>
</div>
</div>
</section>
<section id="univariate-statistics" class="slide level2">
<h2>Univariate Statistics</h2>
<p>There are multiple tests to compare the mean of a single, continuous explanatory variable to a theoretical or hypothetical mean:</p>
<div class="formula">
H<sub>0</sub>: x̄ = μ<sub>0</sub>
</div>
<div class="fragment">
<p>The three possible alternative hypotheses are:</p>
<div>
<ul>
<li class="fragment">two-tailed → H<sub>a</sub>: x̄ = µ<sub>0</sub> (<code>two.sided</code>)</li>
<li class="fragment">right-tailed → H<sub>a</sub>: x̄ &gt; µ<sub>0</sub> (<code>greater</code>)</li>
<li class="fragment">left-tailed → H<sub>a</sub>: x̄ &lt; µ<sub>0</sub> (<code>less</code>)</li>
</ul>
</div>
</div>
</section>
<section id="one-sample-students-t-test" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-34_1bf2baae8658d814085e8497c267a568">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">t.test</span>(birds<span class="sc">$</span>avg_abund, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  birds$avg_abund
t = 5.065, df = 53, p-value = 5.28e-06
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 3.434453 7.937905
sample estimates:
mean of x 
 5.686179 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean is not equal to 0.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-1" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-35_718af2b97c01e47fbab34f14a56e6975">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="fu">t.test</span>(birds<span class="sc">$</span>avg_abund, <span class="at">mu =</span> <span class="dv">5</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)  <span class="do">## true mean: 5.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  birds$avg_abund
t = 0.61122, df = 53, p-value = 0.5437
alternative hypothesis: true mean is not equal to 5
95 percent confidence interval:
 3.434453 7.937905
sample estimates:
mean of x 
 5.686179 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The mean is equal to 5.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-2" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-36_f7b3269f66dbb6fc9205742c7d5680a0">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="fu">t.test</span>(birds<span class="sc">$</span>avg_abund, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)  <span class="do">## true mean: 5.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  birds$avg_abund
t = 5.065, df = 53, p-value = 5.28e-06
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 3.434453 7.937905
sample estimates:
mean of x 
 5.686179 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean is not equal to 0.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-3" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-37_ce280b4f2cc521bb42d6d97231f8b84c">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="fu">t.test</span>(birds<span class="sc">$</span>avg_abund, <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"greater"</span>)  <span class="do">## true mean: 5.7</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  birds$avg_abund
t = 5.065, df = 53, p-value = 2.64e-06
alternative hypothesis: true mean is greater than 0
95 percent confidence interval:
 3.806753      Inf
sample estimates:
mean of x 
 5.686179 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean is greater than 0.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-4" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="fragment">
<p><strong>Assumption that needs to be fulfilled:</strong></p>
<div>
<ul>
<li class="fragment">a random sample of continuous measurements</li>
<li class="fragment">normality of the data (non-skewed distribution)</li>
<li class="fragment">no knowledge of the true population variance</li>
</ul>
</div>
</div>
</section>
<section id="check-normality-of-the-data" class="slide level2">
<h2>Check Normality of the Data</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-38_7ebfb547751678695cdcb929bf5d88e2">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="fu">shapiro.test</span>(birds<span class="sc">$</span>avg_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  birds$avg_abund
W = 0.59272, p-value = 5.394e-11</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The values are not distributed normally.</span></p>
</div>
<p><br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-39_fdc02642431605e49236c676c5e87ed0">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a><span class="fu">shapiro.test</span>(<span class="fu">log10</span>(birds<span class="sc">$</span>avg_abund))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  log10(birds$avg_abund)
W = 0.9846, p-value = 0.7124</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The (log-transformed) values are distributed normally.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-5" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-40_884ec88ebf057576f2a479ec3e4cfc1b">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">t.test</span>(<span class="fu">log10</span>(birds<span class="sc">$</span>avg_abund), <span class="at">mu =</span> <span class="dv">0</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)  <span class="do">## true mean: .5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  log10(birds$avg_abund)
t = 6.5546, df = 53, p-value = 2.347e-08
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 0.3227987 0.6074655
sample estimates:
mean of x 
0.4651321 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean is not equal to 0.</span></p>
</div>
</section>
<section id="one-sample-students-t-test-6" class="slide level2">
<h2>One-Sample Student’s t-Test</h2>
<p>A formal statistical test to compare the mean of a continuous variable to a theoretical or hypothetical mean is the <strong>one-sample student’s t-test</strong>.<br><br></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-41_21d5bc0638e9785439c605e9ce0b7141">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a><span class="fu">t.test</span>(<span class="fu">log10</span>(birds<span class="sc">$</span>avg_abund), <span class="at">mu =</span> .<span class="dv">5</span>, <span class="at">alternative =</span> <span class="st">"two.sided"</span>)  <span class="do">## true mean: .5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One Sample t-test

data:  log10(birds$avg_abund)
t = -0.49135, df = 53, p-value = 0.6252
alternative hypothesis: true mean is not equal to 0.5
95 percent confidence interval:
 0.3227987 0.6074655
sample estimates:
mean of x 
0.4651321 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The mean is equal to 0.5.</span></p>
</div>
</section>
<section id="one-sample-z-test" class="slide level2">
<h2>One-Sample z-Test</h2>
<p>Another approach to test for differences of the population average is the <em>z-test</em>.<br>
<br></p>
<h4 id="why-and-when">Why and When?</h4>
<div>
<ul>
<li class="fragment">If the variation in the population is known <strong>and</strong></li>
<li class="fragment">if the sample size is ≥ 30</li>
</ul>
</div>
</section>
<section id="one-sample-z-test-1" class="slide level2">
<h2>One-Sample z-Test</h2>
<p>Let’s create some large sample with a known mean and variation:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-42_4aa92ee9d355e7139b80079e4960853f">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb61-2"><a href="#cb61-2"></a>dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-distribution-normal_3a4cd865f4c08526e33c7ba84ab1d67d">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-distribution-normal-1.png" width="1800"></p>
</div>
</div>
</div>
</section>
<section id="one-sample-z-test-2" class="slide level2">
<h2>One-Sample z-Test</h2>
<p>Let’s create some large sample with a known mean and variation:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-44_85083cefdc312210e81b651998721bb6">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-45_d4a9d036ad704e9d9e1bf890c70511ce">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co"># install.packages("BSDA")</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>BSDA<span class="sc">::</span><span class="fu">z.test</span>(dist, <span class="at">mu =</span> <span class="dv">500</span>, <span class="at">sigma.x =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-sample z-Test

data:  dist
z = -0.36835, p-value = 0.7126
alternative hypothesis: true mean is not equal to 500
95 percent confidence interval:
 492.6372 505.0331
sample estimates:
mean of x 
 498.8352 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The mean is equal to 500.</span></p>
</div>
</section>
<section id="one-sample-z-test-3" class="slide level2">
<h2>One-Sample z-Test</h2>
<p>Let’s create some large sample with a known mean and variation:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-46_843917d783055b1236969d23a37cce39">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb65-2"><a href="#cb65-2"></a>dist <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">500</span>, <span class="at">sd =</span> <span class="dv">100</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-47_50f346650dfa80016f8576b2d9b6db26">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a><span class="co"># install.packages("BSDA")</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>BSDA<span class="sc">::</span><span class="fu">z.test</span>(dist, <span class="at">mu =</span> <span class="dv">500</span>, <span class="at">sigma.x =</span> <span class="dv">10</span>) <span class="do">## note that mu fits but sigma.x doesn't!</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    One-sample z-Test

data:  dist
z = -3.6835, p-value = 0.0002301
alternative hypothesis: true mean is not equal to 500
95 percent confidence interval:
 498.2154 499.4550
sample estimates:
mean of x 
 498.8352 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean is not equal to 500.</span></p>
</div>
</section></section>
<section>
<section id="statistical-analysis-bivariate-data" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Bivariate Data —</b></h1>

</section>
<section id="bivariate-data" class="slide level2">
<h2>Bivariate Data</h2>
<p><span class="simple-highlight-grn">Bivariate</span> describes data that consist of <strong>two characteristics</strong>.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-bivariate-boxplot-diet_08aadc74418509bc12550071ab4751f8">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-bivariate-boxplot-diet-1.png" width="1000"></p>
</div>
</div>
</div>
<div class="fragment quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="cell" data-hash="4_modeling_cache/revealjs/ggplot-birds-bivariate-pie-passerines_e235df278d223ba544100899222e0148">
<div class="cell-output-display">
<p><img data-src="4_modeling_files/figure-revealjs/ggplot-birds-bivariate-pie-passerines-1.png" width="1000"></p>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="responses-and-predictors" class="slide level2">
<h2>Responses and Predictors</h2>
<p>A bivariate statistical model describes the relationship between <strong>a response variable</strong> and <strong>one or more predictor variables</strong>.</p>
<div>
<ul>
<li class="fragment"><strong>response variable:</strong><br>variable we want to explain, also known as the <strong>dependent variable</strong></li>
<li class="fragment"><strong>explanatory variable(s):</strong><br>variable(s) that can (potentially) explain the response variable</li>
</ul>
</div>
</section>
<section id="our-research-question" class="slide level2">
<h2>Our Research Question</h2>
<h4 id="hypothesis">Hypothesis</h4>
<blockquote>
<p>The <strong>habitat preferences of different bird species affect the average abundance</strong> due to different availability of habitat.</p>
</blockquote>
<div class="fragment">
<!-- -->
<h4 id="prediction">Prediction</h4>
<blockquote>
<p>The average abundance differs between aquatic and terrestrial bird families.</p>
</blockquote>
</div>
</section>
<section id="two-sample-students-t-test" class="slide level2">
<h2>Two-Sample Student’s t-Test</h2>
<div class="fragment">
<p>A formal statistical test to test for difference a single, categorical explanatory variable with two levels is the <strong>two-sample student’s t-test</strong>.<br><br></p>
</div>
<div class="fragment">
<p><strong>Assumptions that needs to be fulfilled:</strong></p>
<div>
<ul>
<li class="fragment">Normality of the data (non-skewed distribution)</li>
<li class="fragment">Homoscedasticity (similar variance of both levels)</li>
</ul>
</div>
<div class="fragment">
<div class="small">
<p>The robustness of the t-test increases with sample size and is higher when groups have equal sizes.</p>
</div>
</div>
</div>
</section>
<section id="verify-assumptions-for-t-test" class="slide level2">
<h2>Verify Assumptions for t-Test</h2>
<p>Check sample sizes:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-50_80b599343954c197abfd07cf49e53dad">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="fu">count</span>(birds, aquatic)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  aquatic     n
  &lt;fct&gt;   &lt;int&gt;
1 0          39
2 1          15</code></pre>
</div>
</div>
<div class="fragment">
<p>Check equality of variances:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-51_8815f4f23e0c40daae5badda48043153">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="fu">var.test</span>(avg_abund <span class="sc">~</span> aquatic, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  avg_abund by aquatic
F = 0.84667, num df = 38, denom df = 14, p-value = 0.6559
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 0.3155069 1.8900778
sample estimates:
ratio of variances 
         0.8466711 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The ratio is equal to 1, i.e.&nbsp;variances are equal.</span></p>
</div>
</section>
<section id="two-sample-students-t-test-1" class="slide level2">
<h2>Two-Sample Student’s t-Test</h2>
<p>A formal statistical test to test for difference a single, categorical explanatory variable with two levels is the <strong>two-sample student’s t-test</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-52_425e4be230e68202443e7386010998b2">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="fu">t.test</span>(avg_abund <span class="sc">~</span> aquatic, <span class="at">data =</span> birds, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  avg_abund by aquatic
t = -0.14964, df = 52, p-value = 0.8816
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 -5.455121  4.697991
sample estimates:
mean in group 0 mean in group 1 
       5.581022        5.959587 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The abundance does not differ between groups.</span></p>
</div>
</section>
<section id="our-research-question-1" class="slide level2">
<h2>Our Research Question</h2>
<h4 id="hypothesis-1">Hypothesis</h4>
<blockquote>
<p>The <strong>habitat preferences of different bird species affect the average abundance</strong> due to different availability of habitat.</p>
</blockquote>
<div class="fragment">
<!-- -->
<h4 id="prediction-1">Prediction</h4>
<blockquote>
<p>The average <strong>abundance of aquatic families is lower</strong> than the average abundance of terrestrial families.</p>
</blockquote>
</div>
</section>
<section id="unilateral-two-sample-students-t-test" class="slide level2">
<h2>Unilateral Two-Sample Student’s t-Test</h2>
<p>One can also test whether one mean is higher than the other one:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-53_0d5dd543218fe578a34ad340d53b823e">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a><span class="do">## mean of level 1 is "greater" than that of level 2</span></span>
<span id="cb74-2"><a href="#cb74-2"></a><span class="fu">t.test</span>(avg_abund <span class="sc">~</span> aquatic, <span class="at">data =</span> birds, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Two Sample t-test

data:  avg_abund by aquatic
t = -0.14964, df = 52, p-value = 0.5592
alternative hypothesis: true difference in means between group 0 and group 1 is greater than 0
95 percent confidence interval:
 -4.615312       Inf
sample estimates:
mean in group 0 mean in group 1 
       5.581022        5.959587 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The means do not differ between groups.</span></p>
</div>
</section>
<section id="visualize-the-populations" class="slide level2">
<h2>Visualize the Populations</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> aquatic, <span class="at">y =</span> avg_abund)) <span class="sc">+</span></span>
<span id="cb76-2"><a href="#cb76-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb76-3"><a href="#cb76-3"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Terrestrial families"</span>, <span class="st">"Aquatic families"</span>)) <span class="sc">+</span></span>
<span id="cb76-4"><a href="#cb76-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Average abundance"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-abund-aquatic-1.png" width="1200" class="r-stretch quarto-figure-center"></section>
<section id="theme-settings" class="slide level2">
<h2>Theme Settings</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-55_c5f4f6f3a34d8e4ba2661bb3f805243e">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_minimal</span>(</span>
<span id="cb77-2"><a href="#cb77-2"></a>  <span class="at">base_size =</span> <span class="dv">18</span>,</span>
<span id="cb77-3"><a href="#cb77-3"></a>  <span class="at">base_family =</span> <span class="st">"Asap Condensed"</span></span>
<span id="cb77-4"><a href="#cb77-4"></a>))</span>
<span id="cb77-5"><a href="#cb77-5"></a></span>
<span id="cb77-6"><a href="#cb77-6"></a><span class="fu">theme_update</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="your-turn-t-test" class="slide level2">
<h2>Your Turn: t-Test</h2>
<div class="exercise">
<div>
<ul>
<li class="fragment">Test for difference of mass in passerine versus other bird families.
<ul>
<li class="fragment">Check the assumptions for a t-test.</li>
<li class="fragment">If needed, account for potential problems.</li>
</ul></li>
<li class="fragment">Test if the mass of passerine families is significantly lower than that of non-passerine bird families.</li>
<li class="fragment">Visualize the relationship.</li>
</ul>
</div>
</div>
<p><br></p>
<div class="fragment">
<!-- -->
<h4 id="prediction-2">Prediction</h4>
<blockquote>
<p>In bird families belonging to the passerine order we observe lower body masses compared to the non-passerine families.</p>
</blockquote>
</div>
</section>
<section id="verify-assumptions-for-t-test-1" class="slide level2">
<h2>Verify Assumptions for t-Test</h2>
<p>Check sample sizes:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-56_bc8ce0d951c4dfebfe66b1bf8b76c370">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="fu">count</span>(birds, passerine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  passerine     n
  &lt;fct&gt;     &lt;int&gt;
1 0            29
2 1            25</code></pre>
</div>
</div>
<div class="fragment">
<p>Check equality of variances:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-57_f76a28335352d7523df474dec7789d97">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a><span class="fu">var.test</span>(mass <span class="sc">~</span> passerine, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  mass by passerine
F = 2212.2, num df = 28, denom df = 24, p-value &lt; 2.2e-16
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
  993.6119 4808.3462
sample estimates:
ratio of variances 
          2212.237 </code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The ratio is not equal to 1, i.e.&nbsp;variances are not equal.</span></p>
</div>
</section>
<section id="verify-assumptions-for-t-test-2" class="slide level2">
<h2>Verify Assumptions for t-Test</h2>
<p>Check sample sizes:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-58_5a8dd6914d607e458c823cfd61231060">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="fu">count</span>(birds, passerine)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  passerine     n
  &lt;fct&gt;     &lt;int&gt;
1 0            29
2 1            25</code></pre>
</div>
</div>
<p>Check equality of variances:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-59_529eaeb6fb11c696fe2e262be13e02a4">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="fu">var.test</span>(<span class="fu">log10</span>(mass) <span class="sc">~</span> passerine, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    F test to compare two variances

data:  log10(mass) by passerine
F = 4.1318, num df = 28, denom df = 24, p-value = 0.0007421
alternative hypothesis: true ratio of variances is not equal to 1
95 percent confidence interval:
 1.855784 8.980621
sample estimates:
ratio of variances 
          4.131828 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The ratio is not equal to 1, i.e.&nbsp;variances are not equal.</span></p>
</div>
</section>
<section id="welch-t-test" class="slide level2">
<h2>Welch t-Test</h2>
<p>In case the equality in variance assumption is violated, one can run a Welch Two-Sample test:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-60_d9edd2998ddc17d6a627b6cb55b408c1">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="fu">t.test</span>(<span class="fu">log10</span>(mass) <span class="sc">~</span> passerine, <span class="at">data =</span> birds, <span class="at">alternative =</span> <span class="st">"two.sided"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  log10(mass) by passerine
t = 8.16, df = 42.061, p-value = 3.313e-10
alternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0
95 percent confidence interval:
 0.8969327 1.4863194
sample estimates:
mean in group 0 mean in group 1 
       2.503130        1.311504 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The means differ between groups.</span></p>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ Masses differ significantly between passserine and other families.</span></p>
</div>
</section>
<section id="welch-t-test-1" class="slide level2">
<h2>Welch t-Test</h2>
<p>In case the equality in variance assumption is violated, one can run a Welch Two-Sample test:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-61_a117c8047a844680b07ade7e77be75c7">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="do">## log10(mass) is greater in 0 compared to 1 =&gt; passerine less</span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="fu">t.test</span>(<span class="fu">log10</span>(mass) <span class="sc">~</span> passerine, <span class="at">data =</span> birds, <span class="at">alternative =</span> <span class="st">"greater"</span>, <span class="at">var.equal =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Welch Two Sample t-test

data:  log10(mass) by passerine
t = 8.16, df = 42.061, p-value = 1.657e-10
alternative hypothesis: true difference in means between group 0 and group 1 is greater than 0
95 percent confidence interval:
 0.946014      Inf
sample estimates:
mean in group 0 mean in group 1 
       2.503130        1.311504 </code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The mean of 0 is greater than that of 1.</span></p>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ Passserines are significantly lighter than other families.</span></p>
</div>
</section>
<section id="visualize-the-populations-1" class="slide level2">
<h2>Visualize the Populations</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="fu">plot</span>(birds<span class="sc">$</span>passerine, birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/plot-birds-mass-passerine-1.png" width="1200" class="r-stretch quarto-figure-center"></section>
<section id="visualize-the-populations-2" class="slide level2">
<h2>Visualize the Populations</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(passerine), <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Passerine families"</span>, <span class="st">"Non-passerine families"</span>)) <span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"Body mass (g)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-mass-passerine-1.png" width="1200" class="r-stretch quarto-figure-center"></section>
<section id="visualize-the-populations-3" class="slide level2">
<h2>Visualize the Populations</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> forcats<span class="sc">::</span><span class="fu">fct_rev</span>(passerine), <span class="at">y =</span> <span class="fu">log10</span>(mass))) <span class="sc">+</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">notch =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Passerine families"</span>, <span class="st">"Non-passerine families"</span>)) <span class="sc">+</span></span>
<span id="cb92-4"><a href="#cb92-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="cn">NULL</span>, <span class="at">y =</span> <span class="st">"log10(body mass)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-mass-passerine-log-1.png" width="1200" class="r-stretch quarto-figure-center"></section>
<section id="mann-whitney-u-test" class="slide level2">
<h2>Mann-Whitney U Test</h2>
<p>The <strong>Mann-Whitney U test</strong> (or <strong>Wilcoxon rank-sum test</strong>) is the nonparametric equivalent of the two sample t-test which is more flexible to compare distributions of two populations.<br>
<br></p>
<h4 id="why-and-when-1">Why and When?</h4>
<div class="incrementaal">
<ul>
<li>If the distribution of the data is not symmetric<sup>*</sup> <strong>and</strong></li>
<li>if your sample size is rather low (n &lt; 100)</li>
</ul>
</div>
<div class="fragment">
<div class="small">
<p><sup>*</sup> We have ignored that fact so far</p>
</div>
</div>
</section>
<section id="mann-whitney-u-test-1" class="slide level2">
<h2>Mann-Whitney U Test</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-65_5ec96807f4e6d4ad813246dc41dc0fb1">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a><span class="fu">wilcox.test</span>(birds<span class="sc">$</span>mass[birds<span class="sc">$</span>aquatic <span class="sc">==</span> <span class="dv">0</span>], birds<span class="sc">$</span>mass[birds<span class="sc">$</span>aquatic <span class="sc">==</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Wilcoxon rank sum exact test

data:  birds$mass[birds$aquatic == 0] and birds$mass[birds$aquatic == 1]
W = 31, p-value = 7.63e-09
alternative hypothesis: true location shift is not equal to 0</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The abundance differ between groups.</span></p>
</div>
<div class="fragment">
<p>Note that before, using the t-test (which assumes normality!) we have rejected H<sub>a</sub>!</p>
</div>
</section></section>
<section>
<section id="statistical-analysis-linear-model" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Linear Model —</b></h1>

</section>
<section id="our-research-question-2" class="slide level2">
<h2>Our Research Question</h2>
<h4 id="hypothesis-2">Hypothesis</h4>
<blockquote>
<p>For different bird species, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints (e.g.&nbsp;due to the amount of food sources needed and habitat availability).</p>
</blockquote>
<div class="fragment">
<div class="question">
<p>What would be a suitable prediction to test our hypothesis?</p>
</div>
</div>
</section>
<section id="our-research-question-3" class="slide level2">
<h2>Our Research Question</h2>
<h4 id="hypothesis-3">Hypothesis</h4>
<blockquote>
<p>For different bird species, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints (e.g.&nbsp;due to the amount of food sources needed and habitat availability).</p>
</blockquote>
<h4 id="prediction-3">Prediction</h4>
<blockquote>
<p>Species characterized by larger individuals have lower maximum abundance.</p>
</blockquote>
</section>
<section id="visual-exploration" class="slide level2">
<h2>Visual Exploration</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/plot-birds-mass-abundance_495cea89366e003fc24359e9503b6442">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1"></a><span class="fu">plot</span>(birds<span class="sc">$</span>mass, birds<span class="sc">$</span>max_abund)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/plot-birds-mass-abundance-1.png" width="1800" class="r-stretch"></section>
<section id="visual-exploration-1" class="slide level2">
<h2>Visual Exploration</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>(g <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> mass, <span class="at">y =</span> max_abund)) <span class="sc">+</span></span>
<span id="cb96-2"><a href="#cb96-2"></a>      <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body mass (g)"</span>, <span class="at">y =</span> <span class="st">"Maximum abundance"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-mass-abundance-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="linear-model-lm" class="slide level2">
<h2>Linear Model (LM)</h2>
<p><strong>Linear Models</strong> describe a continuous response variable as a function of one or more predictor variables and are also called <strong>linear regression</strong> models.<br>
<br></p>
<div class="fragment">
<p>There are multiple types of LMs (and different names), including:</p>
<div>
<ul>
<li class="fragment"><strong>simple LM</strong>: one predictor and one response variable</li>
<li class="fragment"><strong>multiple LM</strong>: one predictor and <u>several response variables</u></li>
<li class="fragment"><strong>multivariate LM</strong>: <u>multiple predictors</u> and one or several response variables</li>
</ul>
</div>
</div>
</section>
<section id="formulation-of-the-linear-model" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<p>In a simple linear model, we define an observation of</p>
<div>
<ul>
<li class="fragment">the <strong>response variable <code>y</code></strong> as y<sub>1</sub>
<ul>
<li class="fragment">here: <code>max_abund</code> of bird family <code>i</code></li>
</ul></li>
<li class="fragment">the <strong>predictor <code>x</code></strong> as x<sub>1</sub>
<ul>
<li class="fragment">here: <code>mass</code> of bird family <code>i</code></li>
</ul></li>
</ul>
</div>
<p><br></p>
</section>
<section id="formulation-of-the-linear-model-1" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<div class="formula">
y<sub>i</sub> = β<sub>0</sub> + β<sub>1</sub> × x<sub>i</sub> + ε<sub>i</sub>
</div>
<div>
<ul>
<li class="fragment"><i class="serif">y<sub>i</sub></i> is the <strong>response variable</strong></li>
<li class="fragment"><i class="serif">x<sub>i</sub></i> is the <strong>predictor</strong></li>
<li class="fragment"><i class="serif">β<sub>0</sub></i> is the <strong>intercept</strong></li>
<li class="fragment"><i class="serif">β<sub>1</sub></i> is the <b>effect of <i class="serif">x</i> on <i class="serif">y</i></b></li>
<li class="fragment"><i class="serif">ε<sub>i</sub></i> is the <strong>unexplained variation</strong> (called residual)</li>
<li class="fragment">the <strong>predicted value</strong> of <i class="serif">y<sub>i</sub></i> is defined as <i class="serif">ŷ = β<sub>0</sub> + β<sub>1</sub> × x<sub>i</sub></i></li>
</ul>
</div>
</section>
<section id="formulation-of-the-linear-model-2" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<div class="formula" style="font-size:1.6em;">
max_abund<sub>i</sub> = β<sub>0</sub> + β<sub>1</sub> × mass<sub>i</sub> + ε<sub>i</sub>
</div>
</section>
<section id="the-residuals" class="slide level2">
<h2>The Residuals</h2>
<p><b class="simple-highlight-ylw">The residuals <i class="serif">ε<sub>i</sub></i> must follow a normal distribution.</b></p>
<div class="formula">
ε<sub>i</sub> ~ 𝒩 (0, σ<sup>2</sup>)
</div>
<div>
<ul>
<li class="fragment">with a mean of <i class="serif">0</i>
<ul>
<li class="fragment">the majority of the residuals have a value close to 0</li>
<li class="fragment">i.e.&nbsp;the error is very small</li>
</ul></li>
<li class="fragment">with a variance of <i class="serif">σ<sup>2</sup></i>
<ul>
<li class="fragment">their distribution is symmetrical</li>
<li class="fragment">i.e.&nbsp;the response variable is underestimated as well as overestimated)</li>
</ul></li>
</ul>
</div>
</section>
<section id="the-residuals-1" class="slide level2">
<h2>The Residuals</h2>
<p><strong>Thus, each observation <i class="serif">y<sub>i</sub></i> follows a normal distribution.</strong></p>
<div class="formula">
y<sub>i</sub> ~ 𝒩 (ŷ, σ<sup>2</sup>)
</div>
<div>
<ul>
<li class="fragment">with a mean of <i class="serif">ŷ = β<sub>0</sub> + β<sub>1</sub> × x<sub>i</sub></i></li>
<li class="fragment">with a variance of <i class="serif">σ<sup>2</sup></i></li>
</ul>
</div>
</section>
<section id="the-residuals-2" class="slide level2">
<h2>The Residuals</h2>
<p><b class="simple-highlight-ylw">The residuals must be homoscedastic.</b></p>
<div>
<ul>
<li class="fragment">the error does not change much for different values of the explanatory variables
<ul>
<li class="fragment">all residuals ε follow the same distribution</li>
<li class="fragment">the variance σ<sup>2</sup> remains constant</li>
</ul></li>
</ul>
</div>
</section>
<section id="the-residuals-3" class="slide level2">
<h2>The Residuals</h2>
<p><b class="simple-highlight-ylw">The residuals must be independent.</b></p>
<div>
<ul>
<li class="fragment">no missing structure in the model
<ul>
<li class="fragment">e.g.&nbsp;no presence of temporal or spatial autocorrelation</li>
</ul></li>
</ul>
</div>
</section>
<section id="model-estimation" class="slide level2">
<h2>Model Estimation</h2>
<p><b class="simple-highlight-ylw">→ find the “best” estimates of the parameters of the parameters <i class="serif">β<sub>0</sub></i> and <i class="serif">β<sub>1</sub></i>.</b></p>
<div>
<ul>
<li class="fragment">“best” parameters are those that minimize the variation in the response variable</li>
<li class="fragment">the most common method is called <strong>ordinary least squares (OLS)</strong></li>
</ul>
</div>
</section>
<section id="finding-the-best-fit-ols" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-points-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="finding-the-best-fit-ols-1" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-lines-1-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="finding-the-best-fit-ols-2" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-lines-2-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="finding-the-best-fit-ols-3" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-lines-3-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="finding-the-best-fit-ols-4" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-ols-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="finding-the-best-fit-ols-5" class="slide level2">
<h2>Finding the Best Fit: OLS</h2>

<img data-src="4_modeling_files/figure-revealjs/ggplot-regression-residuals-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="formulation-of-the-linear-model-3" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<br>
<div class="formula">
<p>y<sub>i</sub> = β<sub>0</sub> + β<sub>1</sub> × x<sub>i</sub> + ε<sub>i</sub><br> <span style="font-weight:300;">with</span> ε<sub>i</sub> ~ 𝒩 (0, σ<sup>2</sup>)</p>
</div>
</section>
<section id="formulation-of-the-linear-model-4" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<br>
<div class="formula" style="font-size:2em;">
<p>max_abund<sub>i</sub> = β<sub>0</sub> + β<sub>1</sub> × mass<sub>i</sub> + ε<sub>i</sub><br> <span style="font-weight:300;">with</span> ε<sub>i</sub> ~ 𝒩 (0, σ<sup>2</sup>)</p>
</div>
</section>
<section id="formulation-of-the-linear-model-5" class="slide level2">
<h2>Formulation of the Linear Model</h2>
<p><br> In R, the model formula is way less complex—it’s simply</p>
<div class="fct">
<p>max_abund ~ mass</p>
</div>
<div class="fragment">
<p>with the response variable on the left and the predictor variable(s) on the right</p>
</div>
</section>
<section id="formulate-and-run-the-model" class="slide level2">
<h2>Formulate and Run the Model</h2>
<p>The <code>lm()</code> command is used to fit a linear model:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-74_4c9ee13804a5e9468f4f1bbafbce1d93">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a>lm_birds <span class="ot">&lt;-</span> <span class="fu">lm</span>(max_abund <span class="sc">~</span> mass, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>where the first argument is the model formula and the second is the input data.</p>
</section>
<section id="examine-the-model-output" class="slide level2">
<h2>Examine the Model Output</h2>
<p>By printing the <code>lm_birds</code> object, we can inspect the parameter estimates:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-75_c26d2f73e5a0878f7d3a2e52351b01cd">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>lm_birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = max_abund ~ mass, data = birds)

Coefficients:
(Intercept)         mass  
   38.16646      0.01439  </code></pre>
</div>
</div>
</section>
<section id="examine-the-model-output-1" class="slide level2">
<h2>Examine the Model Output</h2>
<p>We can retrieve a more informative output of the model with <code>summary()</code>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-76_1ed24461a04d1852fa8e1f595d594282">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a><span class="fu">summary</span>(lm_birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = max_abund ~ mass, data = birds)

Residuals:
   Min     1Q Median     3Q    Max 
-79.30 -35.39 -22.06   2.62 373.72 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept) 38.16646   11.09065   3.441  0.00115 **
mass         0.01439    0.01059   1.358  0.18021   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 72.89 on 52 degrees of freedom
Multiple R-squared:  0.03427,   Adjusted R-squared:  0.0157 
F-statistic: 1.845 on 1 and 52 DF,  p-value: 0.1802</code></pre>
</div>
</div>
</section>
<section id="examine-the-model-output-2" class="slide level2">
<h2>Examine the Model Output</h2>
<p>We can also retrieve the <strong>“Analysis of Variance”</strong> table with <code>anova()</code>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-77_dcf641d310ca82f19aedb410021724cf">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="fu">anova</span>(lm_birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: max_abund
          Df Sum Sq Mean Sq F value Pr(&gt;F)
mass       1   9803  9803.3  1.8452 0.1802
Residuals 52 276273  5313.0               </code></pre>
</div>
</div>
</section>
<section id="verify-assumptions-for-lm" class="slide level2">
<h2>Verify Assumptions for LM</h2>
<p>To check if the residuals do not violate the four basic assumptions, we can retrieve diagnostic plots via <code>plot(lm_birds)</code>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-78_e807f764e7c766ad7115651b3824745a">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="fu">plot</span>(lm_birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-1-residuals-vs-fitted" class="slide level2">
<h2>Diagnostic Plot 1: Residuals vs Fitted</h2>
<p><br></p>
<h3 id="what-the-plot-shows">What the plot shows:</h3>
<div>
<ul>
<li class="fragment"><strong>distribution of the residuals versus predicted values</strong>
<ul>
<li class="fragment">point show the distance between the response variable and the model prediction</li>
<li class="fragment">allows to check the <strong>independence of the residuals and their distribution</strong></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<!-- -->
<h3 id="what-we-want-to-see">What we want to see:</h3>
<div>
<ul>
<li class="fragment"><strong>no dispersion of the points → homoscedasticity</strong>
<ul>
<li class="fragment">randomly scattered points across fitted values</li>
<li class="fragment">a horizontal red line around a value of 0</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="diagnostic-plot-1-residuals-vs-fitted-1" class="slide level2">
<h2>Diagnostic Plot 1: Residuals vs Fitted</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-good-1-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-1-residuals-vs-fitted-2" class="slide level2">
<h2>Diagnostic Plot 1: Residuals vs Fitted</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-1-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-1-residuals-vs-fitted-3" class="slide level2">
<h2>Diagnostic Plot 1: Residuals vs Fitted</h2>

<img data-src="img/4_modeling/diagnostics-1.png" class="r-stretch quarto-figure-center"><p class="caption">Source: <a href="https://r.qcbs.ca/workshop04/book-en/linear-regression-in-r.html">Quebec Centre for Biodiversity Science</a></p></section>
<section id="diagnostic-plot-2-normal-q-q" class="slide level2">
<h2>Diagnostic Plot 2: Normal Q-Q</h2>
<p><br></p>
<h3 id="what-the-plot-shows-1">What the plot shows:</h3>
<div>
<ul>
<li class="fragment"><strong>distribution of the residuals versus quantiles of a Normal distribution</strong>
<ul>
<li class="fragment">points show the distance between normally distributed values and the model prediction</li>
<li class="fragment">allows to check the <strong>if the distribution of residuals can be considered normaly distributed</strong></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<!-- -->
<h3 id="what-we-want-to-see-1">What we want to see:</h3>
<div>
<ul>
<li class="fragment"><strong>a 1:1 relationship → normal distribution</strong>
<ul>
<li class="fragment">the points fall on or close to the grey line</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="diagnostic-plot-2-normal-q-q-1" class="slide level2">
<h2>Diagnostic Plot 2: Normal Q-Q</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-good-2-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-2-normal-q-q-2" class="slide level2">
<h2>Diagnostic Plot 2: Normal Q-Q</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-2-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality" class="slide level2">
<h2>Test for Normality</h2>
<p>A formal statistical test to check the assumption of normally distributed residuals is the <strong>Shapiro-Wilk test</strong>.</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-85_d20b494c9ce18f5dddc8be766d328fba">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm_birds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lm_birds)
W = 0.64158, p-value = 3.172e-10</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The residuals are not distributed normally.</span></p>
</div>
</section>
<section id="diagnostic-plot-3-scale-location" class="slide level2">
<h2>Diagnostic Plot 3: Scale Location</h2>
<p><br></p>
<h3 id="what-the-plot-shows-2">What the plot shows:</h3>
<div>
<ul>
<li class="fragment"><strong>distribution of the square-rooted residuals versus predicted values</strong>
<ul>
<li class="fragment">points show the distance between the response variable and the model prediction</li>
<li class="fragment">allows to check the <strong>dispersion of the residuals</strong></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<!-- -->
<h3 id="what-we-want-to-see-2">What we want to see:</h3>
<div>
<ul>
<li class="fragment"><strong>no trends → evenly distributed predictor</strong>
<ul>
<li class="fragment">randomly scattered points across fitted values</li>
<li class="fragment">a flat red line</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="diagnostic-plot-3-scale-location-1" class="slide level2">
<h2>Diagnostic Plot 3: Scale Location</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-good-3-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-3-scale-location-2" class="slide level2">
<h2>Diagnostic Plot 3: Scale Location</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-3-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="test-for-homoscedasticity" class="slide level2">
<h2>Test for Homoscedasticity</h2>
<p>A formal statistical test to check the assumption of homoscedasticity is the <strong>Breusch-Pagan test</strong>.</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-88_83657c01093023fe4004a14029b61f70">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a><span class="co"># install.packages("lmtest")</span></span>
<span id="cb107-2"><a href="#cb107-2"></a>lmtest<span class="sc">::</span><span class="fu">bptest</span>(lm_birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  lm_birds
BP = 0.096381, df = 1, p-value = 0.7562</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: homoscedasticity</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ Our model does not meet the assumption of homoscedasticity.</span></p>
</div>
</section>
<section id="diagnostic-plot-4-residuals-vs-leverage" class="slide level2">
<h2>Diagnostic Plot 4: Residuals vs Leverage</h2>
<p><br></p>
<h3 id="what-the-plot-shows-3">What the plot shows:</h3>
<div>
<ul>
<li class="fragment"><strong>distribution of the residuals versus leverage</strong>
<ul>
<li class="fragment">leverage refers to the extent to which the coefficients would change if a particular observation was removed</li>
<li class="fragment">allows to check <strong>if certain values have a strong(er) influence</strong></li>
</ul></li>
</ul>
</div>
<div class="fragment">
<!-- -->
<h3 id="what-we-want-to-see-3">What we want to see:</h3>
<div>
<ul>
<li class="fragment"><strong>no influential obervations → homoscedastic residuals</strong>
<ul>
<li class="fragment">points inside of <em>Cook’s distance</em></li>
<li class="fragment">especially no outliers for high values of leverage</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="diagnostic-plot-4-residuals-vs-leverage-1" class="slide level2">
<h2>Diagnostic Plot 4: Residuals vs Leverage</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-good-4-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="diagnostic-plot-4-residuals-vs-leverage-2" class="slide level2">
<h2>Diagnostic Plot 4: Residuals vs Leverage</h2>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-4-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="assumptions-not-metwhats-wrong" class="slide level2">
<h2>Assumptions Not Met—What’s Wrong?</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/plot-birds-hist-residuals_d0db7424970a97bfca5c25027b0aaf2e">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a><span class="fu">hist</span>(<span class="fu">residuals</span>(lm_birds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/plot-birds-hist-residuals-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="assumptions-not-metwhats-wrong-1" class="slide level2">
<h2>Assumptions Not Met—What’s Wrong?</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-hist-residuals_3a6c3218bc252998eb49db8605dd39d1">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">residuals =</span> <span class="fu">residuals</span>(lm_birds)), <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-hist-residuals-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="assumptions-not-metwhats-wrong-2" class="slide level2">
<h2>Assumptions Not Met—What’s Wrong?</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-lm_a732ec88d5cbc87a6f130a18d249e94f">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a>g <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-lm-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="assumptions-not-metwhat-now" class="slide level2">
<h2>Assumptions Not Met—What Now?</h2>
<p><strong>Potential Solutions:</strong></p>
<div>
<ul>
<li class="fragment">use a different model approach, e.g.&nbsp;a generalized linear model (GLM)</li>
<li class="fragment">transformation of the response and/or predictor variable(s)
<ul>
<li class="fragment">transforming variables and interpreting the results is often tricky in practice</li>
</ul></li>
</ul>
</div>
</section>
<section id="transform-the-variables-visually" class="slide level2">
<h2>Transform the Variables (Visually)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-log-scales-x_6a5cdc7dfbba45552743afc86ab0839d">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">name =</span> <span class="st">"log10(body mass)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-log-scales-x-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="transform-the-variables-visually-1" class="slide level2">
<h2>Transform the Variables (Visually)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-log-scales-xy_b3fb322c80b3e4a8d68ce126d5171a35">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">name =</span> <span class="st">"log10(body mass)"</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">name =</span> <span class="st">"log10(maximum abundance)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-log-scales-xy-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="transform-the-variables-visually-2" class="slide level2">
<h2>Transform the Variables (Visually)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-log-scales-fit_c3dacf26350cb4c490ab799c688c7dbf">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a>g <span class="sc">+</span> <span class="fu">scale_x_log10</span>(<span class="at">name =</span> <span class="st">"log10(body mass)"</span>) <span class="sc">+</span> <span class="fu">scale_y_log10</span>(<span class="at">name =</span> <span class="st">"log10(maximum abundance)"</span>) <span class="sc">+</span></span>
<span id="cb114-2"><a href="#cb114-2"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-log-scales-fit-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="transform-the-variables-visually-3" class="slide level2">
<h2>Transform the Variables (Visually)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-log-coord_735cc0d4575d1d8e05422ff59279e43a">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1"></a>g <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">x =</span> <span class="st">"log10"</span>, <span class="at">y =</span> <span class="st">"log10"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-log-coord-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="transform-the-variables-visually-4" class="slide level2">
<h2>Transform the Variables (Visually)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-log-coord-fit_ce7b983cf40ca91e1dafd26f491a14bf">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a>g <span class="sc">+</span> <span class="fu">coord_trans</span>(<span class="at">x =</span> <span class="st">"log10"</span>, <span class="at">y =</span> <span class="st">"log10"</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-log-coord-fit-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="your-turn-linear-models" class="slide level2">
<h2>Your Turn: Linear Models</h2>
<div class="exercise">
<div>
<ul>
<li class="fragment">Add columns to our <code>birds</code> data frame that hold the transformed values for both, the response and the predictor variable.</li>
<li class="fragment">Run the linear model using the transformed values as inputs.</li>
<li class="fragment">Inspect the diagnostic plots to check if all assumptions are met.</li>
<li class="fragment">Interpret the model outcomes.</li>
<li class="fragment">Visualize the model trend and the distribution of residuals.</li>
<li class="fragment"><strong>Bonus:</strong> Fit and explore a model for terrestrial birds only.</li>
</ul>
</div>
</div>
</section>
<section id="transform-the-variables" class="slide level2">
<h2>Transform the Variables</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-99_0bc5f70d68d24c70643060cc39632001">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1"></a>birds <span class="ot">&lt;-</span> birds <span class="sc">%&gt;%</span> </span>
<span id="cb117-2"><a href="#cb117-2"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(max_abund, mass), log10, <span class="at">.names =</span> <span class="st">"{col}_log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-100_127fd35378cde2ef02097d96f7f3fd8d">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a>birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 9
   family             max_abund avg_abund   mass diet        passerine aquatic max_abund_log mass_log
   &lt;fct&gt;                  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;    &lt;dbl&gt;
 1 Hawks&amp;Eagles&amp;Kites      2.99     0.674  716.  Vertebrate  0         0               0.475    2.85 
 2 Long-tailed tits       37.8      4.04     5.3 Insect      1         0               1.58     0.724
 3 Larks                 241.      23.1     35.8 PlantInsect 1         0               2.38     1.55 
 4 Kingfishers             4.4      0.595  119.  Vertebrate  0         0               0.643    2.08 
 5 Auks&amp; Puffins           4.53     2.96   315.  InsectVert  0         1               0.656    2.50 
 6 Ducks&amp; Geese           23.7      2.74  1144.  PlantInsect 0         1               1.37     3.06 
 7 Anhingas               24.6      1.84  1250   Vertebrate  0         1               1.39     3.10 
 8 Swifts                 44.0      3.95    27.4 Insect      0         0               1.64     1.44 
 9 Limpkins                1.6      0.567 1100   Insect      0         1               0.204    3.04 
10 Herons&amp; Egrets         46.5      2.97   462.  Vertebrate  0         1               1.67     2.66 
# … with 44 more rows</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p>Alternatively:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-101_f45dae44f6ef6e5445534123dfda7d3a">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a>birds <span class="ot">&lt;-</span> birds <span class="sc">%&gt;%</span> </span>
<span id="cb120-2"><a href="#cb120-2"></a>  <span class="fu">mutate</span>(<span class="at">log_max_abund =</span> <span class="fu">log10</span>(max_abund), <span class="at">log_mass =</span> <span class="fu">log10</span>(mass))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="transform-the-variables-1" class="slide level2">
<h2>Transform the Variables</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-102_d0085840a5427a030f8d173ee8f52b01">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1"></a>birds <span class="ot">&lt;-</span> birds <span class="sc">%&gt;%</span> </span>
<span id="cb121-2"><a href="#cb121-2"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(max_abund, mass), log10, <span class="at">.names =</span> <span class="st">"{col}_log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-103_8977d19f67b59dbf680e31c5f313c255">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a>birds</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 54 × 9
   family             max_abund avg_abund   mass diet        passerine aquatic max_abund_log mass_log
   &lt;fct&gt;                  &lt;dbl&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;           &lt;dbl&gt;    &lt;dbl&gt;
 1 Hawks&amp;Eagles&amp;Kites      2.99     0.674  716.  Vertebrate  0         0               0.475    2.85 
 2 Long-tailed tits       37.8      4.04     5.3 Insect      1         0               1.58     0.724
 3 Larks                 241.      23.1     35.8 PlantInsect 1         0               2.38     1.55 
 4 Kingfishers             4.4      0.595  119.  Vertebrate  0         0               0.643    2.08 
 5 Auks&amp; Puffins           4.53     2.96   315.  InsectVert  0         1               0.656    2.50 
 6 Ducks&amp; Geese           23.7      2.74  1144.  PlantInsect 0         1               1.37     3.06 
 7 Anhingas               24.6      1.84  1250   Vertebrate  0         1               1.39     3.10 
 8 Swifts                 44.0      3.95    27.4 Insect      0         0               1.64     1.44 
 9 Limpkins                1.6      0.567 1100   Insect      0         1               0.204    3.04 
10 Herons&amp; Egrets         46.5      2.97   462.  Vertebrate  0         1               1.67     2.66 
# … with 44 more rows</code></pre>
</div>
</div>
<p><span class="simple-highlight-ylw">Equivalent code in base R:</span></p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-104_1e0818944ea7c8aa100667baecc9311e">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1"></a>birds<span class="sc">$</span>log_max_abund <span class="ot">&lt;-</span> <span class="fu">log10</span>(birds<span class="sc">$</span>max_abund)</span>
<span id="cb124-2"><a href="#cb124-2"></a>birds<span class="sc">$</span>log_mass      <span class="ot">&lt;-</span> <span class="fu">log10</span>(birds<span class="sc">$</span>mass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="run-the-model-and-inspect-outcomes" class="slide level2">
<h2>Run the Model and Inspect Outcomes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-105_9859e6ba3f7192b741bf4c34c5926869">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1"></a>lm_log <span class="ot">&lt;-</span> <span class="fu">lm</span>(max_abund_log <span class="sc">~</span> mass_log, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-106_9765d0876d61c0cdd87981a3c220cf22">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1"></a><span class="fu">plot</span>(lm_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/plot-lm-log_d33b0cde5dfc5a57eac8ea9a5007dde3">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="4_modeling_files/figure-revealjs/plot-lm-log-1.png" width="3200"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="visualize-the-residuals" class="slide level2">
<h2>Visualize the Residuals</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-hist-residuals-trans_e16c39f3fb36dd4645d960d14a9e7343">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">residuals =</span> <span class="fu">residuals</span>(lm_log)), <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-hist-residuals-trans-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality-1" class="slide level2">
<h2>Test for Normality</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-109_9617babfbae2ca0c6a7ce6275a4a6dc8">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm_log))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lm_log)
W = 0.98557, p-value = 0.7582</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The residuals are distributed normally.</span></p>
</div>
<p><br></p>
</section>
<section id="model-interpretation" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different bird species, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-110_1a175b3f8cae89309251808a4b545795">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1"></a><span class="fu">summary</span>(lm_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = max_abund_log ~ mass_log, data = birds)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.93562 -0.39982  0.05487  0.40625  1.61469 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.6724     0.2472   6.767 1.17e-08 ***
mass_log     -0.2361     0.1170  -2.019   0.0487 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6959 on 52 degrees of freedom
Multiple R-squared:  0.07267,   Adjusted R-squared:  0.05484 
F-statistic: 4.075 on 1 and 52 DF,  p-value: 0.04869</code></pre>
</div>
</div>
</div>
</section>
<section id="model-interpretation-1" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different bird species, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-111_584bde13bc230ab5f2ff9847feea4df9">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1"></a><span class="fu">anova</span>(lm_log)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: max_abund_log
          Df  Sum Sq Mean Sq F value  Pr(&gt;F)  
mass_log   1  1.9736 1.97357   4.075 0.04869 *
Residuals 52 25.1844 0.48431                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-interpretation-2" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different bird species, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-112_c212e124039ea7a9067f550913b59727">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1"></a><span class="fu">summary</span>(lm_log)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  1.6723673  0.2471519  6.766557 1.166186e-08
mass_log    -0.2361498  0.1169836 -2.018658 4.869342e-02</code></pre>
</div>
</div>
<div class="fragment">
<p><code> log10(abundance) = 1.672 - 0.236(log10(mass)) </code></p>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-113_826efe75d07a749d495c5cd3fc45477e">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1"></a><span class="fu">summary</span>(lm_log)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.05483696</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">The model using transformed response and predictor variables has&nbsp;<br>&nbsp;<b style="font-weight:800;">very little evidence to support the hypothesis</b>.</span></p>
</div>
</section>
<section id="create-a-subset" class="slide level2">
<h2>Create a Subset</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-114_3219c257512b2142fce3ecaf7991dc46">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1"></a>birds_terrestrial <span class="ot">&lt;-</span> <span class="fu">filter</span>(birds, aquatic <span class="sc">==</span> <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-115_04c3c35e5b91b81b43375bf821f92e40">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1"></a>birds_terrestrial</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 39 × 9
   family                          max_abund avg_abund  mass diet        passerine aquatic max_abund…¹ mass_…²
   &lt;fct&gt;                               &lt;dbl&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;       &lt;fct&gt;     &lt;fct&gt;         &lt;dbl&gt;   &lt;dbl&gt;
 1 Hawks&amp;Eagles&amp;Kites                   2.99     0.674 716.  Vertebrate  0         0             0.475   2.85 
 2 Long-tailed tits                    37.8      4.04    5.3 Insect      1         0             1.58    0.724
 3 Larks                              241.      23.1    35.8 PlantInsect 1         0             2.38    1.55 
 4 Kingfishers                          4.4      0.595 119.  Vertebrate  0         0             0.643   2.08 
 5 Swifts                              44.0      3.95   27.4 Insect      0         0             1.64    1.44 
 6 Waxwings                            11.7      2.80   42.3 PlantInsect 1         0             1.07    1.63 
 7 Nightjars                            9.10     1.57   57.8 Insect      0         0             0.959   1.76 
 8 Cardinals&amp; Buntings&amp; Grosbreaks     49.8      6.62   24.0 PlantInsect 1         0             1.70    1.38 
 9 Creepers                             9.6      1.03    8.4 Insect      1         0             0.982   0.924
10 Pigeons &amp; Doves                     14.9      3.04  141.  Plant       0         0             1.17    2.15 
# … with 29 more rows, and abbreviated variable names ¹​max_abund_log, ²​mass_log</code></pre>
</div>
</div>
</div>
</section>
<section id="run-the-model" class="slide level2">
<h2>Run the Model</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-116_b2e09c601a51f1640984b779123ff9c5">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1"></a>lm_terr <span class="ot">&lt;-</span> <span class="fu">lm</span>(max_abund_log <span class="sc">~</span> mass_log, <span class="at">data =</span> birds_terrestrial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Alternatively, you can also specify the subset in the <code>lm()</code> call:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-117_2275f3b49525da6433729b93b945e15e">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1"></a>lm_terr <span class="ot">&lt;-</span> <span class="fu">lm</span>(max_abund_log <span class="sc">~</span> mass_log, <span class="at">data =</span> birds, <span class="at">subset =</span> birds<span class="sc">$</span>aquatic <span class="sc">==</span> <span class="st">"0"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="verify-assumptions-for-lm-1" class="slide level2">
<h2>Verify Assumptions for LM</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-118_a6c102e3484c5d40344b3b7dace965fc">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1"></a><span class="fu">plot</span>(lm_terr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-terr-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="visualize-the-residuals-1" class="slide level2">
<h2>Visualize the Residuals</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-hist-residuals-terr_76f7021cf97a4b1a448f7799b7a8e54b">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1"></a><span class="fu">ggplot</span>(<span class="fu">tibble</span>(<span class="at">residuals =</span> <span class="fu">residuals</span>(lm_terr)), <span class="fu">aes</span>(<span class="at">x =</span> residuals)) <span class="sc">+</span> <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-hist-residuals-terr-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality-2" class="slide level2">
<h2>Test for Normality</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-121_bb543f4828477c7573017917e42fccd5">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm_terr))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lm_terr)
W = 0.94367, p-value = 0.05041</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The resdiuals are distributed normally (but only barely).</span></p>
</div>
<p><br></p>
</section>
<section id="model-interpretation-3" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different <b style="font-weight:800;color:#28A87D;">terrestial bird species</b>, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-122_19c524a59ced8c5481ece7c9028af2c1">
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1"></a><span class="fu">summary</span>(lm_terr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = max_abund_log ~ mass_log, data = birds_terrestrial)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.78289 -0.23135  0.04031  0.22932  1.68109 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   2.2701     0.2931   7.744 2.96e-09 ***
mass_log     -0.6429     0.1746  -3.683 0.000733 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6094 on 37 degrees of freedom
Multiple R-squared:  0.2682,    Adjusted R-squared:  0.2485 
F-statistic: 13.56 on 1 and 37 DF,  p-value: 0.000733</code></pre>
</div>
</div>
</div>
</section>
<section id="model-interpretation-4" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different <b style="font-weight:800;color:#28A87D;">terrestial bird species</b>, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-123_fabcd35053dcb8fdf05e153033aa889a">
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1"></a><span class="fu">anova</span>(lm_terr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: max_abund_log
          Df  Sum Sq Mean Sq F value   Pr(&gt;F)    
mass_log   1  5.0374  5.0374  13.562 0.000733 ***
Residuals 37 13.7426  0.3714                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</section>
<section id="model-interpretation-5" class="slide level2">
<h2>Model Interpretation</h2>
<blockquote>
<p>For different <b style="font-weight:800;color:#28A87D;">terrestial bird species</b>, the <b>average mass of an individual affects the maximum abundance of the species</b>, due to ecological constraints.</p>
</blockquote>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-124_922a9561aae40f3a9e1cd450a5cb0d36">
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1"></a><span class="fu">summary</span>(lm_terr)<span class="sc">$</span>coefficients</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              Estimate Std. Error   t value     Pr(&gt;|t|)
(Intercept)  2.2701276  0.2931420  7.744122 2.961050e-09
mass_log    -0.6428946  0.1745703 -3.682726 7.329516e-04</code></pre>
</div>
</div>
<div class="fragment">
<p><code> log10(abundance) = 2.27 - 0.643(log10(mass)) </code></p>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-125_dfe12d0cabf9cfd7fc6e4349d838803f">
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1"></a><span class="fu">summary</span>(lm_terr)<span class="sc">$</span>adj.r.squared</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.2484544</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">The model provides <b style="font-weight:800;">evidence to support the hypothesis</b>.</span></p>
</div>
</section>
<section id="including-more-predictor-variables" class="slide level2">
<h2>Including More Predictor Variables</h2>
<p>We can also use more than a single predictor. Let’s explore the relationship but including the information on passerine families and habitat preference:</p>

<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-lm-passerine-aquatic-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="including-more-predictor-variables-1" class="slide level2">
<h2>Including More Predictor Variables</h2>
<p>We can also use more than a single predictor. Let’s explore the relationship but including the information on passerine families:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-127_f443db40628b7d695c594cade8eb6181">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1"></a>lm_mult <span class="ot">&lt;-</span> <span class="fu">lm</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> passerine, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="including-more-predictor-variables-2" class="slide level2">
<h2>Including More Predictor Variables</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-128_fcf1e67625378c40480e6e1b5006e2a3">
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1"></a><span class="fu">plot</span>(lm_mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-mult-1.png" width="3200" class="r-stretch quarto-figure-center"><p>:::</p>
</section>
<section id="model-interpretation-6" class="slide level2">
<h2>Model Interpretation</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-130_658c3187e2b1730f51e8f4168ed5e5fd">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1"></a><span class="fu">summary</span>(lm_mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = max_abund_log ~ mass_log + passerine, data = birds)

Residuals:
     Min       1Q   Median       3Q      Max 
-1.67861 -0.29704 -0.01518  0.41162  1.40084 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  0.82215    0.43158   1.905   0.0624 .
mass_log     0.04958    0.16516   0.300   0.7652  
passerine1   0.63206    0.26814   2.357   0.0223 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6673 on 51 degrees of freedom
Multiple R-squared:  0.1638,    Adjusted R-squared:  0.131 
F-statistic: 4.994 on 2 and 51 DF,  p-value: 0.01045</code></pre>
</div>
</div>
<div class="fragment">
<p><code style="font-size:.85em;"> log10(abundance) = 0.882 + 0.049(log10(mass)) + 0.632(passerine) </code></p>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">The model provides <b style="font-weight:800;">evidence to support the hypothesis</b>.</span></p>
</div>
</section>
<section id="back-to-t-tests" class="slide level2">
<h2>Back to t-Tests</h2>
<p>Note that a t-test is equal to a <span class="simple-highlight-ylw">linear model for a factor with two levels</span>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-131_a77cb5f1db64c2ed8a6376768b1781dd">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1"></a>lm_ttest <span class="ot">&lt;-</span> <span class="fu">lm</span>(mass_log <span class="sc">~</span> aquatic, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-132_a79c2127801b9414eea1bb42bd5c2613">
<div class="sourceCode cell-code" id="cb160"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1"></a>ttest_lm <span class="ot">&lt;-</span> <span class="fu">t.test</span>(mass_log <span class="sc">~</span> aquatic, <span class="at">data =</span> birds, <span class="at">var.equal =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>When variances are equal we can see that <code>t<sup>2</sup> == F</code>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-133_53a4a2f7f422c2a6c484824eea2b081c">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1"></a><span class="fu">anova</span>(lm_ttest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: mass_log
          Df Sum Sq Mean Sq F value    Pr(&gt;F)    
aquatic    1 19.015 19.0150  60.385 2.936e-10 ***
Residuals 52 16.375  0.3149                      
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-134_3ba307d7fd8465fcc41fc9f5bcb7ccaa">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb163-1"><a href="#cb163-1"></a>ttest_lm<span class="sc">$</span>statistic<span class="sc">^</span><span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      t 
60.3845 </code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="statistical-analysis-analysis-of-variance" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Analysis of Variance —</b></h1>

</section>
<section id="analysis-of-variance-anova" class="slide level2">
<h2>Analysis of Variance (ANOVA)</h2>
<p>An <strong>analysis of Variance (ANOVA)</strong> is used to <strong>compare variances across the means</strong> of different groups (factors).<br>
<br></p>
<div class="fragment">
<!-- -->
<h4 id="why-and-when-2">Why and When?</h4>
<p>An ANOVA tells you if the dependent variable changes according to the level of the independent variable.</p>
<div>
<ul>
<li class="fragment">If you collected data about one categorical independent variable and one quantitative dependent variable.</li>
<li class="fragment">If the categorical independent variable has three or more levels.</li>
</ul>
</div>
</div>
</section>
<section id="analysis-of-variance-anova-1" class="slide level2">
<h2>Analysis of Variance (ANOVA)</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-135_1381321ce8167b725f4bcb36f2c3b007">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb165-1"><a href="#cb165-1"></a>aov_diet <span class="ot">&lt;-</span> <span class="fu">aov</span>(max_abund_log <span class="sc">~</span> diet, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<p>Note that a simple ANOVA is equal to a <span class="simple-highlight-ylw">linear model for a factor with more&nbsp;<br>&nbsp;than two levels</span>.</p>
</div>
</section>
<section id="verify-assumptions-for-anova" class="slide level2">
<h2>Verify Assumptions for ANOVA</h2>
<p>An ANOVA must meet the same four residual assumptions as linear models:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-136_eb7b38c35f8e5cc03318d7d9fb45fac1">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb166-1"><a href="#cb166-1"></a><span class="fu">plot</span>(aov_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-aov-birds-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="verify-assumptions-for-anova-1" class="slide level2">
<h2>Verify Assumptions for ANOVA</h2>
<p>Test for normality with the <strong>Shapiro-Wilk test</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-138_74253ec410e742f3d10cc409404dc81a">
<div class="sourceCode cell-code" id="cb167"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb167-1"><a href="#cb167-1"></a><span class="fu">shapiro.test</span>(<span class="fu">resid</span>(aov_diet))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  resid(aov_diet)
W = 0.97995, p-value = 0.4982</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The residuals are distributed normally.</span></p>
</div>
</section>
<section id="verify-assumptions-for-anova-2" class="slide level2">
<h2>Verify Assumptions for ANOVA</h2>
<p>Assess the homogeneity of residuals variance with a <strong>Bartlett test</strong>:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-139_8f43fddb9f23a8d890aa75010553ba59">
<div class="sourceCode cell-code" id="cb169"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1"></a><span class="fu">bartlett.test</span>(max_abund_log <span class="sc">~</span> diet, <span class="at">data =</span> birds)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  max_abund_log by diet
Bartlett's K-squared = 7.4728, df = 4, p-value = 0.1129</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: the variances are equal</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The residuals are equal (homoscedastic).</span></p>
</div>
</section>
<section id="model-output" class="slide level2">
<h2>Model Output</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-140_28defe946ab36bddd1250a33c556fb21">
<div class="sourceCode cell-code" id="cb171"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1"></a><span class="fu">summary</span>(aov_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value Pr(&gt;F)  
diet         4  5.106   1.276   2.836 0.0341 *
Residuals   49 22.052   0.450                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><br></p>
<div class="fragment">
<p>… which is the same as the outcome of the simple LM:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-141_e8ee5f9bcacf32d3a022cd165ea4fd3f">
<div class="sourceCode cell-code" id="cb173"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb173-1"><a href="#cb173-1"></a><span class="fu">anova</span>(<span class="fu">lm</span>(max_abund_log <span class="sc">~</span> diet, <span class="at">data =</span> birds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Response: max_abund_log
          Df  Sum Sq Mean Sq F value Pr(&gt;F)  
diet       4  5.1059 1.27647  2.8363 0.0341 *
Residuals 49 22.0521 0.45004                 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
</section>
<section id="complementary-tests" class="slide level2">
<h2>Complementary Tests</h2>
<p><strong>An ANOVA (or LM) only detects if a difference is present</strong>;<br>it cannot identify which levels are different from the others.</p>
<div class="fragment">
<p>Complementary <strong>post-hoc tests</strong> are used compare the levels of the explanatory variables (i.e.&nbsp;the treatments) two by two, e.g.</p>
<div>
<ul>
<li class="fragment">Fischer’s least significant difference</li>
<li class="fragment">Duncan’s new multiple range test</li>
<li class="fragment">Newman-Keuls method</li>
<li class="fragment">Dunnett’s test</li>
<li class="fragment">Tukey honest significant differences</li>
</ul>
</div>
</div>
</section>
<section id="tukey-post-hoc-test" class="slide level2">
<h2>Tukey Post-Hoc Test</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-142_46346cc7b3a4a6b26debc014bc830269">
<div class="sourceCode cell-code" id="cb175"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb175-1"><a href="#cb175-1"></a><span class="fu">TukeyHSD</span>(aov_diet, <span class="at">ordered =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Tukey multiple comparisons of means
    95% family-wise confidence level
    factor levels have been ordered

Fit: aov(formula = max_abund_log ~ diet, data = birds)

$diet
                            diff         lwr      upr     p adj
Vertebrate-InsectVert  0.3364295 -1.11457613 1.787435 0.9645742
Insect-InsectVert      0.6434334 -0.76550517 2.052372 0.6965047
Plant-InsectVert       0.8844338 -1.01537856 2.784246 0.6812494
PlantInsect-InsectVert 1.0657336 -0.35030287 2.481770 0.2235587
Insect-Vertebrate      0.3070039 -0.38670951 1.000717 0.7204249
Plant-Vertebrate       0.5480043 -0.90300137 1.999010 0.8211024
PlantInsect-Vertebrate 0.7293041  0.02128588 1.437322 0.0405485
Plant-Insect           0.2410004 -1.16793813 1.649939 0.9884504
PlantInsect-Insect     0.4223003 -0.19493574 1.039536 0.3117612
PlantInsect-Plant      0.1812999 -1.23473664 1.597336 0.9961844</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>The only significant difference in abundance occurs between the diet types <code>PlantInsect</code> and <code>Vertebrate</code>.</p>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-143_91cead2ac7656593b0771921dc53062c">
<div class="cell-output cell-output-stdout">
<pre><code>                            diff        lwr      upr      p adj
PlantInsect-Vertebrate 0.7293041 0.02128588 1.437322 0.04054849</code></pre>
</div>
</div>
</div>
</section></section>
<section>
<section id="statistical-analysis-mixed-effect-model" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Mixed Effect Model —</b></h1>

</section>
<section id="linear-mixed-model-lmm" class="slide level2">
<h2>Linear Mixed Model (LMM)</h2>
<p><strong>Linear mixed models (LMMs)</strong> (also known as <strong>mixed effect models</strong>) are an extension of simple linear models that <strong>allow both fixed and random effects</strong>.<br>
<br></p>
<div class="fragment">
<!-- -->
<h4 id="why-and-when-3">Why and when?</h4>
<p>A <strong>random effect</strong> specifies grouping factors for which we want to control for<br>but their specific effect on the response variable is not necessarily of interest.</p>
<div>
<ul>
<li class="fragment">If there is an inherent structure to data (i.e.&nbsp;single observations are not strictly independent), relationships between variables of interest might differ depending on grouping factors.</li>
<li class="fragment">If sample sizes are low, it is difficult to fit models that require many parameters to be estimated.</li>
</ul>
</div>
</div>
</section>
<section id="linear-mixed-model-lmm-1" class="slide level2">
<h2>Linear Mixed Model (LMM)</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-lm-diet_96520c8f31829ab0ba619b72496e271e">
<div class="sourceCode cell-code" id="cb178"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb178-1"><a href="#cb178-1"></a><span class="fu">ggplot</span>(birds, <span class="fu">aes</span>(<span class="at">x =</span> mass, <span class="at">y =</span> max_abund, <span class="at">color =</span> diet)) <span class="sc">+</span></span>
<span id="cb178-2"><a href="#cb178-2"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span> <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb178-3"><a href="#cb178-3"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>) <span class="sc">+</span></span>
<span id="cb178-4"><a href="#cb178-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body mass (g)"</span>, <span class="at">y =</span> <span class="st">"Maximum abundance"</span>, <span class="at">color =</span> <span class="st">"Diet type:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-lm-diet-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="prepare-data" class="slide level2">
<h2>Prepare Data</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-145_adca7715130e4d297f4d997a0911e223">
<div class="sourceCode cell-code" id="cb179"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1"></a>birds_diet <span class="ot">&lt;-</span> </span>
<span id="cb179-2"><a href="#cb179-2"></a>  birds <span class="sc">%&gt;%</span> </span>
<span id="cb179-3"><a href="#cb179-3"></a>  <span class="fu">add_count</span>(diet) <span class="sc">%&gt;%</span> </span>
<span id="cb179-4"><a href="#cb179-4"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb179-5"><a href="#cb179-5"></a>  <span class="fu">mutate</span>(<span class="at">diet =</span> <span class="fu">factor</span>(<span class="fu">as.character</span>(diet)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="prepare-data-1" class="slide level2">
<h2>Prepare Data</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-birds-lm-diet-boxplot_4987124400f5c510fea5c39d4641739c">
<div class="sourceCode cell-code" id="cb180"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1"></a><span class="fu">ggplot</span>(birds_diet, <span class="fu">aes</span>(<span class="at">x =</span> diet, <span class="at">y =</span> mass)) <span class="sc">+</span></span>
<span id="cb180-2"><a href="#cb180-2"></a>  <span class="fu">geom_boxplot</span>(<span class="at">color =</span> <span class="st">"grey40"</span>, <span class="at">fill =</span> <span class="st">"grey80"</span>, <span class="at">lwd =</span> .<span class="dv">9</span>, <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb180-3"><a href="#cb180-3"></a>  ggforce<span class="sc">::</span><span class="fu">geom_sina</span>(<span class="at">maxwidth =</span> .<span class="dv">5</span>, <span class="at">alpha =</span> .<span class="dv">5</span>, <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">"#28A87D"</span>) <span class="sc">+</span></span>
<span id="cb180-4"><a href="#cb180-4"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Diet type"</span>, <span class="at">y =</span> <span class="st">"Body mass (g)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-birds-lm-diet-boxplot-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="linear-mixed-model-lmm-2" class="slide level2">
<h2>Linear Mixed Model (LMM)</h2>
<blockquote>
<p>One point of particular relevance to ‘modern’ mixed model estimation (rather than ‘classical’ method-of-moments estimation) is that, for practical purposes, there must be a reasonable number of random-effects levels — more than 5 or 6 at a minimum.</p>
</blockquote>
<div class="small">
<p><a href="https://bbolker.github.io/mixedmodels-misc/glmmFAQ.html">Ben Bolker</a></p>
</div>
<p><br></p>
<div class="fragment">
<blockquote>
<p>It may be acceptable to use fewer than five levels of random effects if one is not interested in making inferences about the random effects terms.</p>
</blockquote>
<div class="small">
<p><a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC8784019/">Gomes 2022 PeerJ</a></p>
</div>
</div>
</section>
<section id="linear-mixed-model-random-intercepts" class="slide level2">
<h2>Linear Mixed Model: Random Intercepts</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-147_84fa73b21d0723bebdcf6080f053b4cf">
<div class="sourceCode cell-code" id="cb181"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb181-2"><a href="#cb181-2"></a>lm_mixed1 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="small">
<p>As with regular linear models, we define our response variable as the column name to the left of the ~ and define our fixed effects to the right.</p>
</div>
<p>The random effect is defined as <strong>random intercept for each diet type</strong>.<br> The connotation in R is <code>(1 | diet)</code>. <br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-148_b408f33419ecacc0ab3815baf22c7129">
<div class="sourceCode cell-code" id="cb182"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb182-1"><a href="#cb182-1"></a><span class="fu">coef</span>(lm_mixed1)<span class="sc">$</span>diet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)   mass_log
Insect         1.473102 -0.1723018
PlantInsect    1.761541 -0.1723018
Vertebrate     1.438901 -0.1723018</code></pre>
</div>
</div>
</div>
</section>
<section id="linear-mixed-model-random-slopes" class="slide level2">
<h2>Linear Mixed Model: Random Slopes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-149_25a231d19b6752040b0a6df7332cdf29">
<div class="sourceCode cell-code" id="cb184"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb184-1"><a href="#cb184-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb184-2"><a href="#cb184-2"></a>lm_mixed2 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">0</span> <span class="sc">+</span> mass_log <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="small">
<p>As with regular linear models, we define our response variable as the column name to the left of the ~ and define our fixed effects to the right.</p>
</div>
<p>The random effect is defined as <strong>random slopes for each diet type</strong>.<br> The connotation in R is <code>(0 + mass_log | diet)</code>. <br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-150_2c5898921ab86ee30fc615b5a3144132">
<div class="sourceCode cell-code" id="cb185"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb185-1"><a href="#cb185-1"></a><span class="fu">coef</span>(lm_mixed2)<span class="sc">$</span>diet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)   mass_log
Insect          1.61115 -0.2385155
PlantInsect     1.61115 -0.1158075
Vertebrate      1.61115 -0.2183231</code></pre>
</div>
</div>
</div>
</section>
<section id="linear-mixed-model-intercepts-slopes" class="slide level2">
<h2>Linear Mixed Model: Intercepts + Slopes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-151_f9efb07d98b29fc19b0c09e6735a2dd2">
<div class="sourceCode cell-code" id="cb187"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb187-2"><a href="#cb187-2"></a>lm_mixed3 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> mass_log <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="small">
<p>As with regular linear models, we define our response variable as the column name to the left of the ~ and define our fixed effects to the right.</p>
</div>
<p>The random effect is defined as <strong>random intercepts and slopes for each diet type</strong>.<br> The connotation in R is <code>(1 + mass_log | diet)</code>. <br></p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-152_8e6829349df4861c3ccb369186d26060">
<div class="sourceCode cell-code" id="cb188"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1"></a><span class="fu">coef</span>(lm_mixed3)<span class="sc">$</span>diet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            (Intercept)   mass_log
Insect        1.4508274 -0.1551592
PlantInsect   2.1270137 -0.3724646
Vertebrate   -0.8065533  0.5702934</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><code> log10(abundance) = 1.451 - 0.155(log10(mass))<br> log10(abundance) = 2.127 - 0.372(log10(mass))<br> log10(abundance) = -0.807 + 0.57(log10(mass)) </code></p>
</div>
</section>
<section id="linear-mixed-model-intercepts-slopes-1" class="slide level2">
<h2>Linear Mixed Model: Intercepts + Slopes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-153_bf7019d2677ec0366330103dbeafdbdb">
<div class="sourceCode cell-code" id="cb190"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb190-2"><a href="#cb190-2"></a>lm_mixed3 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> mass_log <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/plot-lm-birds-mixed3_f853795631954c3c82fd60649b10b841">
<div class="sourceCode cell-code" id="cb191"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb191-1"><a href="#cb191-1"></a><span class="fu">plot</span>(lm_mixed3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/plot-lm-birds-mixed3-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="linear-mixed-model-intercepts-slopes-2" class="slide level2">
<h2>Linear Mixed Model: Intercepts + Slopes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-155_2d69fa8a8082770124888fb6841b1ba4">
<div class="sourceCode cell-code" id="cb192"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb192-1"><a href="#cb192-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb192-2"><a href="#cb192-2"></a>lm_mixed3 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> mass_log <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-156_1706861495c9bf55db6348e4f5e68130">
<div class="sourceCode cell-code" id="cb193"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb193-1"><a href="#cb193-1"></a><span class="fu">summary</span>(lm_mixed3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: max_abund_log ~ mass_log + (1 + mass_log | diet)
   Data: birds_diet

REML criterion at convergence: 107.3

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-2.8628 -0.5229 -0.1174  0.6914  1.9400 

Random effects:
 Groups   Name        Variance Std.Dev. Corr 
 diet     (Intercept) 2.7626   1.6621        
          mass_log    0.2853   0.5342   -1.00
 Residual             0.4237   0.6509        
Number of obs: 50, groups:  diet, 3

Fixed effects:
            Estimate Std. Error t value
(Intercept)  0.92376    1.04023   0.888
mass_log     0.01422    0.34493   0.041

Correlation of Fixed Effects:
         (Intr)
mass_log -0.989
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="linear-mixed-model-intercepts-slopes-3" class="slide level2">
<h2>Linear Mixed Model: Intercepts + Slopes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-157_37edb09a8c64c022edea59b0e742588c">
<div class="sourceCode cell-code" id="cb195"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1"></a><span class="co"># install.packages("lme4")</span></span>
<span id="cb195-2"><a href="#cb195-2"></a>lm_mixed3 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(max_abund_log <span class="sc">~</span> mass_log <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> mass_log <span class="sc">|</span> diet), <span class="at">data =</span> birds_diet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-158_0e07ad9547c6b43ed26887a7e6c836eb">
<div class="sourceCode cell-code" id="cb196"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1"></a><span class="fu">anova</span>(lm_mixed3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
         npar     Sum Sq    Mean Sq F value
mass_log    1 0.00072047 0.00072047  0.0017</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">The model provides <b style="font-weight:800;">evidence to support the hypothesis</b> that bird families&nbsp;<br>&nbsp;with a higher body mass are more abundant (but it differs per diet typ).</span></p>
</div>
</section></section>
<section>
<section id="statistical-analysis-model-comparison" class="title-slide slide level1 center">
<h1>Statistical Analysis<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Model Comparison —</b></h1>

</section>
<section id="model-comparison" class="slide level2">
<h2>Model Comparison</h2>
<p>An important part of model evaluation is not only their performance in terms of explanation but also their <strong>parsimony</strong>.</p>
<div class="fragment">
<p>A <strong>parsimonious model</strong> is a model that accomplishes the desired level of <strong>explanation or prediction with as few predictor variables as possible</strong>.</p>
</div>
</section>
<section id="model-comparison-1" class="slide level2">
<h2>Model Comparison</h2>
<p>To compare the fits of two models, you can use the <code>anova()</code> function with the regression objects as two separate arguments.</p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-159_4c292cbc61982bf11cf43f81942996ec">
<div class="sourceCode cell-code" id="cb198"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1"></a><span class="fu">anova</span>(lm_log, lm_mult)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: max_abund_log ~ mass_log
Model 2: max_abund_log ~ mass_log + passerine
  Res.Df    RSS Df Sum of Sq      F  Pr(&gt;F)  
1     52 25.184                              
2     51 22.710  1    2.4742 5.5564 0.02229 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
</div>
<div class="fragment">
<div class="small">
<p>If the p-value is sufficiently low, we conclude that the more complex model is significantly better than the simpler model.</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The complex model is more parsimonious.</span></p>
</div>
</section>
<section id="model-comparison-2" class="slide level2">
<h2>Model Comparison</h2>
<p>To compare the fits of two models, you can use the <code>anova()</code> function with the regression objects as two separate arguments.</p>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-160_584e97293f2346347740b2f6e29b82e5">
<div class="sourceCode cell-code" id="cb200"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb200-1"><a href="#cb200-1"></a><span class="fu">anova</span>(lm_mixed1, lm_mixed3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: birds_diet
Models:
lm_mixed1: max_abund_log ~ mass_log + (1 | diet)
lm_mixed3: max_abund_log ~ mass_log + (1 + mass_log | diet)
          npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)
lm_mixed1    4 113.08 120.72 -52.538   105.08                     
lm_mixed3    6 116.71 128.18 -52.355   104.71 0.3665  2     0.8326</code></pre>
</div>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The complex model is not more parsimonious.</span></p>
</div>
</section>
<section id="your-turn" class="slide level2">
<h2>Your Turn 🐉</h2>
<div class="exercise">
<div>
<ul>
<li class="fragment">Import the dragons data set which reports hypothetical outcomes for a fictional study system.</li>
<li class="fragment">Inspect the data and visualize the distributions of the variables.</li>
<li class="fragment">Explore the relationship of <code>test_score</code> and <code>body_length</code>.
<ul>
<li class="fragment">Create a scatter plot showing the relationship of the two variables.</li>
<li class="fragment">Run a <strong>linear model</strong> to test how <code>body_length</code> is affecting <code>test_score</code>.</li>
<li class="fragment">Check if the assumptions for the LM are met or not. If they are met, interpret the model outcomes.</li>
<li class="fragment">Inspect the relationship of the two vasriables for different mountain ranges.</li>
<li class="fragment">Afterwards, run a <strong>linear mixed model</strong> which accounts for <code>mountain_range</code> as random effect.</li>
<li class="fragment">Check if the asumptions for the LMM are met or not. If they are met, interpret the model outcomes and compre the two LMMs for parsimony.</li>
</ul></li>
</ul>
</div>
</div>
</section>
<section id="data" class="slide level2">
<h2>🐉 Data</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-161_62ae863860a399a4c933a274abddd8b5">
<div class="sourceCode cell-code" id="cb202"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1"></a>dragons <span class="ot">&lt;-</span> readr<span class="sc">::</span><span class="fu">read_csv</span>(<span class="st">"./data/dragons.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-162_cb83ee29bf6121d2b2bd90c38f87e3e1">
<div class="sourceCode cell-code" id="cb203"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1"></a><span class="fu">glimpse</span>(dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 480
Columns: 4
$ test_score     &lt;dbl&gt; 16.1473095, 33.8861835, 6.0383329, 18.8388213, 33.8623279, 47.0432459, 2.5578905, 3.8…
$ body_length    &lt;dbl&gt; 165.5485, 167.5593, 165.8830, 167.6855, 169.9597, 168.6887, 169.6194, 164.4163, 167.5…
$ mountain_range &lt;chr&gt; "Bavarian", "Bavarian", "Bavarian", "Bavarian", "Bavarian", "Bavarian", "Bavarian", "…
$ site           &lt;chr&gt; "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", "a", …</code></pre>
</div>
</div>
</div>
</section>
<section id="visualize-distributions" class="slide level2">
<h2>🐉 Visualize Distributions</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-bars-mountain-ranges_f67a2845bd7eadb39d3d6ea5ba4c6021">
<div class="sourceCode cell-code" id="cb205"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> mountain_range)) <span class="sc">+</span> </span>
<span id="cb205-2"><a href="#cb205-2"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb205-3"><a href="#cb205-3"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-bars-mountain-ranges-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="visualize-distributions-1" class="slide level2">
<h2>🐉 Visualize Distributions</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-bars-site_3f86d045dcde09e081b3f91728630bd2">
<div class="sourceCode cell-code" id="cb206"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb206-1"><a href="#cb206-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> site)) <span class="sc">+</span> </span>
<span id="cb206-2"><a href="#cb206-2"></a>  <span class="fu">geom_bar</span>(<span class="at">fill =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb206-3"><a href="#cb206-3"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major.x =</span> <span class="fu">element_blank</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-bars-site-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="visualize-distributions-2" class="slide level2">
<h2>🐉 Visualize Distributions</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-histogram-test-score_71e5153617590d1558ff4f8c4869255e">
<div class="sourceCode cell-code" id="cb207"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb207-1"><a href="#cb207-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> test_score)) <span class="sc">+</span> </span>
<span id="cb207-2"><a href="#cb207-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">25</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">fill =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb207-3"><a href="#cb207-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Test score"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-histogram-test-score-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="visualize-distributions-3" class="slide level2">
<h2>🐉 Visualize Distributions</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-histogram-body-length_37112d60ecd3c5de62fb32593983053a">
<div class="sourceCode cell-code" id="cb208"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> body_length)) <span class="sc">+</span> </span>
<span id="cb208-2"><a href="#cb208-2"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">25</span>, <span class="at">color =</span> <span class="st">"grey60"</span>, <span class="at">fill =</span> <span class="st">"grey60"</span>) <span class="sc">+</span></span>
<span id="cb208-3"><a href="#cb208-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body length"</span>, <span class="at">y =</span> <span class="st">"Count"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-histogram-body-length-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="visualize-relationship" class="slide level2">
<h2>🐉 Visualize Relationship</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-scatter-score-length-lm_429c9f2a8decbb54f18f743b599167e5">
<div class="sourceCode cell-code" id="cb209"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> body_length, <span class="at">y =</span> test_score)) <span class="sc">+</span></span>
<span id="cb209-2"><a href="#cb209-2"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb209-3"><a href="#cb209-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body length"</span>, <span class="at">y =</span> <span class="st">"Test score"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-scatter-score-length-lm-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="run-linear-model" class="slide level2">
<h2>🐉 Run Linear Model</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-168_d3f570815c2da3ca6e9194cfcb799d06">
<div class="sourceCode cell-code" id="cb210"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1"></a>lm_dragons <span class="ot">&lt;-</span> <span class="fu">lm</span>(test_score <span class="sc">~</span> body_length, <span class="at">data =</span> dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-169_ffcc2458ab937e7f8857a2e33eb4a4b7">
<div class="sourceCode cell-code" id="cb211"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1"></a><span class="fu">summary</span>(lm_dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = test_score ~ body_length, data = dragons)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.962 -16.411  -0.783  15.193  55.200 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -61.31783   12.06694  -5.081 5.38e-07 ***
body_length   0.55487    0.05975   9.287  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 21.2 on 478 degrees of freedom
Multiple R-squared:  0.1529,    Adjusted R-squared:  0.1511 
F-statistic: 86.25 on 1 and 478 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</section>
<section id="verify-assumptions-for-lm-2" class="slide level2">
<h2>🐉 Verify Assumptions for LM</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-170_322073825160e629f4e4ecd84fb6dabf">
<div class="sourceCode cell-code" id="cb213"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb213-1"><a href="#cb213-1"></a><span class="fu">plot</span>(lm_dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lm-dragons-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality-3" class="slide level2">
<h2>🐉 Test for Normality</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-172_b906e6bdc568e9c6a90d00e16995d163">
<div class="sourceCode cell-code" id="cb214"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lm_dragons))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lm_dragons)
W = 0.99277, p-value = 0.02053</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<div class="fragment">
<p><span class="simple-highlight-grn">→ We accept H<sub>a</sub>. The residuals are not distributed normally.</span></p>
</div>
</section>
<section id="visualize-relationship-incl.-groups" class="slide level2">
<h2>🐉 Visualize Relationship incl.&nbsp;Groups</h2>
<div class="cell" data-layout-align="center" data-hash="4_modeling_cache/revealjs/ggplot-dragons-scatter-score-length-lm-mountain-ranges_973c6131a8e06cd2579406f9877742ac">
<div class="sourceCode cell-code" id="cb216"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb216-1"><a href="#cb216-1"></a><span class="fu">ggplot</span>(dragons, <span class="fu">aes</span>(<span class="at">x =</span> body_length, <span class="at">y =</span> test_score, <span class="at">color =</span> mountain_range)) <span class="sc">+</span></span>
<span id="cb216-2"><a href="#cb216-2"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> <span class="cn">FALSE</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> .<span class="dv">3</span>) <span class="sc">+</span> </span>
<span id="cb216-3"><a href="#cb216-3"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Body length"</span>, <span class="at">y =</span> <span class="st">"Test score"</span>) <span class="sc">+</span></span>
<span id="cb216-4"><a href="#cb216-4"></a>  <span class="fu">scale_color_brewer</span>(<span class="at">palette =</span> <span class="st">"Dark2"</span>, <span class="at">name =</span> <span class="st">"Mountain range:"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="4_modeling_files/figure-revealjs/ggplot-dragons-scatter-score-length-lm-mountain-ranges-1.png" width="1800" class="r-stretch quarto-figure-center"></section>
<section id="run-linear-mixed-model" class="slide level2">
<h2>🐉 Run Linear Mixed Model</h2>
<p>We run a model with random intercept only:</p>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-174_e040a227c80431cbdb113103157a76cb">
<div class="sourceCode cell-code" id="cb217"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1"></a>lmm_dragons1 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(test_score <span class="sc">~</span> body_length <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">|</span> mountain_range), <span class="at">data =</span> dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verify-assumptions-for-lmm" class="slide level2">
<h2>🐉 Verify Assumptions for LMM</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-175_1588c3dbdd3dca8a3c8a1bc6489c1390">
<div class="sourceCode cell-code" id="cb218"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1"></a><span class="fu">plot</span>(lmm_dragons1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lmm1-dragons-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality-4" class="slide level2">
<h2>🐉 Test for Normality</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-177_1a798115df546240db2bacdc23a215f9">
<div class="sourceCode cell-code" id="cb219"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lmm_dragons1))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lmm_dragons1)
W = 0.99883, p-value = 0.9899</code></pre>
</div>
</div>
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The residuals are distributed normally.</span></p>
</div>
</section>
<section id="inspect-model-outcomes" class="slide level2">
<h2>🐉 Inspect Model Outcomes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-178_a040d449f7fed3e5f5869c74045dab20">
<div class="sourceCode cell-code" id="cb221"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1"></a><span class="fu">summary</span>(lmm_dragons1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: test_score ~ body_length + (1 | mountain_range)
   Data: dragons

REML criterion at convergence: 3991.2

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4815 -0.6513  0.0066  0.6685  2.9583 

Random effects:
 Groups         Name        Variance Std.Dev.
 mountain_range (Intercept) 339.7    18.43   
 Residual                   223.8    14.96   
Number of obs: 480, groups:  mountain_range, 8

Fixed effects:
            Estimate Std. Error t value
(Intercept) 43.70938   17.13489   2.551
body_length  0.03316    0.07865   0.422

Correlation of Fixed Effects:
            (Intr)
body_length -0.924</code></pre>
</div>
</div>
<div class="fragment">
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-179_be771d679bce35de85e6e9eacbd97ea2">
<div class="sourceCode cell-code" id="cb223"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1"></a><span class="fl">339.7</span> <span class="sc">/</span> (<span class="fl">339.7</span> <span class="sc">+</span> <span class="fl">223.8</span>) <span class="sc">*</span> <span class="dv">100</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 60.28394</code></pre>
</div>
</div>
<p>→ Differences between mountain ranges explain ~60% of the variance.</p>
</div>
</section>
<section id="inspect-model-outcomes-1" class="slide level2">
<h2>🐉 Inspect Model Outcomes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-180_5ce1ce38fdd330cd0b7b23f6892d6795">
<div class="sourceCode cell-code" id="cb225"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1"></a><span class="fu">anova</span>(lmm_dragons1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
            npar Sum Sq Mean Sq F value
body_length    1   39.8    39.8  0.1778</code></pre>
</div>
</div>
</section>
<section id="add-random-slope" class="slide level2">
<h2>🐉 Add Random Slope</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-181_c781d2bcb3262a744cf1f0823a1e25bc">
<div class="sourceCode cell-code" id="cb227"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1"></a>lmm_dragons2 <span class="ot">&lt;-</span> lme4<span class="sc">::</span><span class="fu">lmer</span>(test_score <span class="sc">~</span> body_length <span class="sc">+</span> (<span class="dv">1</span> <span class="sc">+</span> body_length <span class="sc">|</span> mountain_range), <span class="at">data =</span> dragons)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="verify-assumptions-for-2nd-lmm" class="slide level2">
<h2>🐉 Verify Assumptions for 2nd LMM</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-182_114b5fb836101f63313ebba79db59b30">
<div class="sourceCode cell-code" id="cb228"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1"></a><span class="fu">plot</span>(lmm_dragons2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="4_modeling_files/figure-revealjs/plot-lmm2-dragons-1.png" width="3200" class="r-stretch quarto-figure-center"></section>
<section id="test-for-normality-5" class="slide level2">
<h2>🐉 Test for Normality</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-184_c991e659b3351b3a149b69ef992612a6">
<div class="sourceCode cell-code" id="cb229"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb229-1"><a href="#cb229-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(lmm_dragons2))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(lmm_dragons2)
W = 0.9988, p-value = 0.9885</code></pre>
</div>
</div>
<div class="fragment">
<div class="small">
<p>Null hypothesis: values follow a normal distribution</p>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The residuals are distributed normally.</span></p>
</div>
</section>
<section id="model-outcomes" class="slide level2">
<h2>🐉 Model Outcomes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-185_c2f9c1b49432e9f44f1e6e9754939c3b">
<div class="sourceCode cell-code" id="cb231"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb231-1"><a href="#cb231-1"></a><span class="fu">summary</span>(lmm_dragons2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed model fit by REML ['lmerMod']
Formula: test_score ~ body_length + (1 + body_length | mountain_range)
   Data: dragons

REML criterion at convergence: 3986.1

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.4983 -0.6666  0.0170  0.6636  2.9454 

Random effects:
 Groups         Name        Variance  Std.Dev. Corr 
 mountain_range (Intercept) 2.757e+03 52.5027       
                body_length 3.047e-02  0.1745  -1.00
 Residual                   2.218e+02 14.8940       
Number of obs: 480, groups:  mountain_range, 8

Fixed effects:
             Estimate Std. Error t value
(Intercept) 51.550397  24.405701   2.112
body_length  0.000565   0.099423   0.006

Correlation of Fixed Effects:
            (Intr)
body_length -0.981
optimizer (nloptwrap) convergence code: 0 (OK)
boundary (singular) fit: see help('isSingular')</code></pre>
</div>
</div>
</section>
<section id="model-outcomes-1" class="slide level2">
<h2>🐉 Model Outcomes</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-186_fc44dead55950e60085e1f45f9e5febc">
<div class="sourceCode cell-code" id="cb233"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb233-1"><a href="#cb233-1"></a><span class="fu">anova</span>(lmm_dragons2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table
            npar    Sum Sq   Mean Sq F value
body_length    1 0.0071647 0.0071647       0</code></pre>
</div>
</div>
</section>
<section id="compare-models" class="slide level2">
<h2>🐉 Compare Models</h2>
<div class="cell" data-hash="4_modeling_cache/revealjs/unnamed-chunk-187_38d3c7c77d95c1fff83d6ed9ef1dc6ee">
<div class="sourceCode cell-code" id="cb235"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1"></a><span class="fu">anova</span>(lmm_dragons1, lmm_dragons2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Data: dragons
Models:
lmm_dragons1: test_score ~ body_length + (1 | mountain_range)
lmm_dragons2: test_score ~ body_length + (1 + body_length | mountain_range)
             npar    AIC    BIC  logLik deviance  Chisq Df Pr(&gt;Chisq)  
lmm_dragons1    4 4001.5 4018.2 -1996.7   3993.5                       
lmm_dragons2    6 4000.3 4025.3 -1994.1   3988.3 5.2019  2     0.0742 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<div class="fragment">
<p><span class="simple-highlight-ylw">→ We reject H<sub>a</sub>. The complex model is not more parsimonious.</span></p>
</div>
</section>
<section id="resources" class="slide level2">
<h2>Resources</h2>
<ul>
<li><a href="https://bookdown.org/ndphillips/YaRrr/htests.html">“YaRrr! The Pirate’s Guide to R” (Ch. 13-15)</a></li>
<li><a href="https://ourcodingclub.github.io/tutorials/mixed-models/">“Introduction to Linear Mixed Models”</a> 🐉</li>
<li><a href="https://glennwilliams.me/r4psych/simple-statistical-tests.html">“R for Psych” (Ch. 6-9)</a></li>
<li><a href="https://rc2e.com/generalstatistics">“R Cookbook” (Ch. 9+11)</a></li>
<li><a href="https://www.tidymodels.org/start/">tiymodels Get-Started Tutorial</a></li>
<li><a href="https://cran.r-project.org/web/packages/DHARMa/vignettes/DHARMa.html">{dharma} Package (diagnostics for hiercharchical models)</a></li>
</ul>
</section></section>
<section>
<section id="whats-next" class="title-slide slide level1 center">
<h1>What’s Next?</h1>

</section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-workflow.png" alt="A conceptional representation of the data science workflow:the first step is data import, afterwards the data gets tidied (prepared, shaped). Then follows an iterative process of visualization, transformation and modeling. Once the final analysis is done, the results need to be communicated." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-model-done.png" alt="The same conceptional representation of the data science workflow with the steps import, tidy, transform, visualize, and model being highlighted in green (as we have already covered these steps)." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section>
<section class="slide level2">

<p><br><br></p>

<img data-src="img/data-science-communicate.png" alt="The same conceptional representation of the data science workflow with the step communicate being highlighted in yellow (as it is coming next)." class="r-stretch quarto-figure-center"><p class="caption">The data science workflow, modified from <a href="https://r4ds.had.co.nz/">“R for Data Science”</a></p></section></section>
<section id="thats-it-folks-thank-you" class="title-slide slide level1 center">
<h1>That’s it Folks…<br><b style="color:#404040;font-size:.7em;font-weight:600;">— Thank you! —</b></h1>

<img src="https://d33wubrfki0l68.cloudfront.net/d4cd9bd8e591d8973d68f98a71544bbe65d53733/79b34/img/logo.png" class="slide-logo r-stretch"><div class="footer footer-default">
<p><strong><a href="https://cedricscherer.com">Cédric Scherer</a> //</strong> R Course TU Dresden <strong>//</strong> Statistical Analysis &amp; Modeling</p>
</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="4_modeling_files/libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="4_modeling_files/libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="4_modeling_files/libs/revealjs/plugin/notes/notes.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/search/search.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="4_modeling_files/libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"theme":"whiteboard","boardmarkerWidth":4},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        target: function(trigger) {
          return trigger.previousElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>